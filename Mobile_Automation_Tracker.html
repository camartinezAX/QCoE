<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Mobile Automation Tracker - Editable</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --axos-orange: #FAA74A;
            --axos-orange-light: #FFF4E6;
            --axos-orange-dark: #E8922E;
            --axos-navy: #1E3860;
            --axos-navy-light: #2A4A7A;
            --axos-navy-dark: #152844;
            --android-green: #3ddc84;
            --ios-black: #000000;
            --gradient-orange: linear-gradient(135deg, #FAA74A 0%, #F7931E 100%);
            --gradient-navy: linear-gradient(135deg, #1E3860 0%, #2A4A7A 100%);
            --shadow-sm: 0 2px 4px rgba(30, 56, 96, 0.08);
            --shadow-md: 0 4px 12px rgba(30, 56, 96, 0.12);
            --shadow-lg: 0 8px 24px rgba(30, 56, 96, 0.16);
            --shadow-glow: 0 0 20px rgba(250, 167, 74, 0.3);
        }
        
        * { box-sizing: border-box; }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
            padding: 0; 
            margin: 0; 
            line-height: 1.6; 
            background: linear-gradient(180deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
        }
        
        .page-header {
            background: var(--gradient-navy);
            padding: 40px 24px;
            margin-bottom: 0;
            position: relative;
            overflow: hidden;
        }
        
        .page-header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, rgba(250, 167, 74, 0.2) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .page-header::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: 10%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(250, 167, 74, 0.15) 0%, transparent 70%);
            border-radius: 50%;
        }
        
        .page-header h1 {
            color: white;
            margin: 0;
            font-size: 2.5rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            position: relative;
            z-index: 1;
        }
        
        .page-header h1 span {
            color: var(--axos-orange);
        }
        
        .page-header p {
            color: rgba(255,255,255,0.8);
            margin: 8px 0 0 0;
            font-size: 1rem;
            position: relative;
            z-index: 1;
        }
        
        .container { 
            background: white; 
            padding: 32px; 
            margin: -20px 24px 24px 24px;
            border-radius: 16px; 
            box-shadow: var(--shadow-lg);
            position: relative;
            z-index: 10;
        }
        table { border-collapse: collapse; width: 100%; margin: 16px 0; }
        th, td { border: 1px solid #e2e8f0; padding: 12px 16px; text-align: left; }
        th { background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%); font-weight: 600; color: var(--axos-navy); }
        tr:hover { background: #f8fafc; }
        
        h1, h2, h3 { color: var(--axos-navy); margin-top: 32px; }
        h2 { 
            font-size: 1.5rem; 
            font-weight: 700; 
            display: flex; 
            align-items: center; 
            gap: 12px;
            padding-bottom: 12px;
            border-bottom: 3px solid var(--axos-orange);
            margin-bottom: 24px;
        }
        h3 { font-size: 1.1rem; font-weight: 600; }
        
        hr { 
            border: none; 
            height: 1px;
            background: linear-gradient(90deg, transparent, #e2e8f0 20%, #e2e8f0 80%, transparent);
            margin: 40px 0; 
        }
        
        .status-badge { 
            display: inline-block; 
            padding: 4px 12px; 
            border-radius: 20px; 
            font-size: 12px; 
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .on-track { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: #065f46; }
        .on-risk { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); color: #991b1b; }
        .ahead { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: #1e40af; }
        .info { background: var(--axos-orange-light); color: var(--axos-navy); }
        .highlight-row { background: #f8fafc; font-weight: 600; }
        .metric-value { font-size: 18px; font-weight: 700; color: var(--axos-navy); }
        .panel { border: 1px solid #e2e8f0; border-radius: 12px; padding: 20px; margin: 16px 0; }
        .panel-success { border-left: 4px solid #10b981; background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); }
        .panel-warning { border-left: 4px solid var(--axos-orange); background: var(--axos-orange-light); }
        .panel-info { border-left: 4px solid var(--axos-navy); background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); }
        
        /* Progress Tracker Styles */
        .tracker-container { 
            overflow-x: auto; 
            margin: 24px 0; 
            border-radius: 12px;
            box-shadow: var(--shadow-md);
            border: 1px solid #e2e8f0;
        }
        .tracker-table { border-collapse: collapse; min-width: 100%; white-space: nowrap; }
        .tracker-table th, .tracker-table td { 
            border: 1px solid #e2e8f0; 
            padding: 8px 10px; 
            text-align: center; 
            min-width: 50px;
            font-size: 12px;
        }
        .tracker-table th { background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%); font-weight: 600; }
        .tracker-table .row-header { 
            background: linear-gradient(90deg, var(--axos-navy) 0%, var(--axos-navy-light) 100%); 
            color: white;
            font-weight: 600; 
            text-align: left; 
            position: sticky; 
            left: 0; 
            z-index: 1;
            min-width: 100px;
            font-size: 11px;
            border: none;
        }
        .tracker-table .month-header { 
            background: var(--gradient-navy); 
            color: white; 
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        .tracker-table .week-header { 
            background: linear-gradient(180deg, var(--axos-navy-light) 0%, var(--axos-navy) 100%);
            color: white;
            font-size: 11px; 
        }
        .tracker-table .platform-header {
            font-size: 11px;
            padding: 6px 8px;
            font-weight: 600;
        }
        .tracker-table .platform-header.android {
            background: linear-gradient(135deg, #3ddc84 0%, #2ecc71 100%);
            color: #073042;
        }
        .tracker-table .platform-header.ios {
            background: linear-gradient(135deg, #2d3748 0%, #1a202c 100%);
            color: white;
        }
        
        /* Platform logos */
        .android-logo {
            display: inline-block;
            width: 14px;
            height: 14px;
            vertical-align: middle;
            margin-right: 2px;
        }
        .ios-logo {
            display: inline-block;
            font-size: 12px;
            vertical-align: middle;
            margin-right: 2px;
        }
        
        /* Editable cells */
        .editable {
            background: linear-gradient(135deg, var(--axos-orange-light) 0%, #fff7ed 100%) !important;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
        }
        .editable:hover {
            background: linear-gradient(135deg, #fed7aa 0%, #fdba74 100%) !important;
            outline: 2px solid var(--axos-orange);
            transform: scale(1.02);
        }
        .editable:focus {
            outline: 3px solid var(--axos-orange);
            background: white !important;
            box-shadow: var(--shadow-glow);
        }
        .editable::after {
            content: 'âœï¸';
            position: absolute;
            top: 2px;
            right: 2px;
            font-size: 8px;
            opacity: 0.4;
            transition: opacity 0.2s;
        }
        .editable:hover::after {
            opacity: 1;
        }
        
        /* Auto-calculated cells */
        .auto-calc {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%) !important;
            font-weight: 600;
        }
        
        .status-cell { font-size: 10px; font-weight: 700; padding: 6px 4px !important; border-radius: 4px; }
        .status-cell.on-track { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: #065f46; }
        .status-cell.on-risk { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); color: #991b1b; }
        .status-cell.ahead { background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: #1e40af; }
        .status-cell.future { background: #f1f5f9; color: #94a3b8; }
        .status-cell.current { background: var(--axos-orange-light); border: 2px solid var(--axos-orange); }
        
        .cumulative-row { background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%) !important; font-weight: 600; }
        .cumulative-row td { border-top: 3px solid #10b981; }
        
        .projected-row { background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%) !important; }
        .projected-row td { border-top: 3px solid var(--axos-navy); font-style: italic; }
        
        .progress-summary { 
            display: flex; 
            gap: 12px; 
            flex-wrap: wrap; 
            margin: 20px 0; 
            padding: 20px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 16px;
            border: 1px solid #e2e8f0;
        }
        .progress-stat { 
            text-align: center; 
            padding: 16px 20px;
            background: white;
            border-radius: 12px;
            border: none;
            min-width: 90px;
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }
        .progress-stat:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .progress-stat-value { 
            font-size: 28px; 
            font-weight: 800; 
            color: var(--axos-navy);
            line-height: 1;
        }
        .progress-stat-label { 
            font-size: 11px; 
            color: #64748b; 
            margin-top: 8px; 
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .progress-stat.auto { 
            border-bottom: 3px solid #10b981;
            background: linear-gradient(180deg, white 0%, #ecfdf5 100%);
        }
        .progress-stat.editable-stat { 
            border-bottom: 3px solid var(--axos-orange);
            background: linear-gradient(180deg, white 0%, var(--axos-orange-light) 100%);
            cursor: pointer; 
        }
        .progress-stat.editable-stat:hover { 
            background: linear-gradient(180deg, white 0%, #fed7aa 100%);
            box-shadow: var(--shadow-glow);
        }
        .progress-stat.android { border-left: 4px solid #3ddc84; }
        .progress-stat.ios { border-left: 4px solid #000000; }
        
        .legend { 
            display: flex; 
            gap: 20px; 
            flex-wrap: wrap; 
            margin: 20px 0; 
            font-size: 12px;
            padding: 16px;
            background: #f8fafc;
            border-radius: 12px;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; font-weight: 500; }
        .legend-color { width: 20px; height: 20px; border-radius: 6px; border: none; box-shadow: var(--shadow-sm); }
        
        .controls { 
            display: flex; 
            gap: 12px; 
            margin: 24px 0; 
            padding: 20px;
            background: linear-gradient(135deg, var(--axos-navy) 0%, var(--axos-navy-light) 100%);
            border-radius: 16px;
            flex-wrap: wrap;
            align-items: center;
            box-shadow: var(--shadow-md);
        }
        .controls button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-sm);
        }
        .controls button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        .btn-primary { background: var(--gradient-orange); color: var(--axos-navy); }
        .btn-primary:hover { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); }
        .btn-success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; }
        .btn-success:hover { background: linear-gradient(135deg, #34d399 0%, #10b981 100%); }
        .btn-warning { background: var(--gradient-orange); color: var(--axos-navy); }
        .btn-warning:hover { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); }
        .btn-danger { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; }
        .btn-danger:hover { background: linear-gradient(135deg, #f87171 0%, #ef4444 100%); }
        
        .save-status {
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
        }
        .save-status.saved { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); color: #065f46; }
        .save-status.unsaved { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); color: #991b1b; }
        
        .instructions {
            background: linear-gradient(135deg, var(--axos-orange-light) 0%, #fff7ed 100%);
            border: 2px solid var(--axos-orange);
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
            box-shadow: var(--shadow-sm);
        }
        .instructions h3 { margin-top: 0; color: var(--axos-navy); font-size: 1.1rem; }
        .instructions ul { margin: 12px 0; padding-left: 24px; }
        .instructions li { margin: 8px 0; color: #475569; }

        .progress-bar-container {
            background: linear-gradient(90deg, #e2e8f0 0%, #f1f5f9 100%);
            border-radius: 12px;
            height: 32px;
            width: 100%;
            position: relative;
            overflow: hidden;
            margin: 12px 0;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .progress-bar-fill {
            height: 100%;
            border-radius: 12px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        .progress-bar-text {
            position: absolute;
            right: 12px;
            top: 7px;
            font-size: 12px;
            font-weight: 700;
            color: #1e293b;
            text-shadow: 0 1px 2px rgba(255,255,255,0.8);
        }
        
        .platform-section {
            margin: 20px 0;
            padding: 24px;
            border-radius: 20px;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
        }
        .platform-section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        .platform-section.android {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 50%, #a7f3d0 100%);
            border: 2px solid #3ddc84;
        }
        .platform-section.ios {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 50%, #e2e8f0 100%);
            border: 2px solid #374151;
        }
        .platform-section h3 {
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.25rem;
            color: var(--axos-navy);
        }
        
        .finish-estimate {
            background: linear-gradient(135deg, var(--axos-navy) 0%, var(--axos-navy-light) 100%);
            border: none;
            border-radius: 20px;
            padding: 32px;
            margin: 24px 0;
            text-align: center;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
        }
        .finish-estimate::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(250, 167, 74, 0.2) 0%, transparent 70%);
            border-radius: 50%;
        }
        .finish-estimate h3 { 
            margin: 0 0 16px 0; 
            color: white; 
            font-size: 1.25rem;
            position: relative;
            z-index: 1;
        }
        .finish-estimate .date { 
            font-size: 28px; 
            font-weight: 800; 
            color: var(--axos-orange);
            position: relative;
            z-index: 1;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        .container > * {
            animation: fadeIn 0.5s ease-out forwards;
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            height: 8px;
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--axos-navy);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--axos-navy-light);
        }
        
        /* Modal styles */
        .modal-overlay {
            backdrop-filter: blur(4px);
        }
        
        .modal input:focus, .modal select:focus {
            outline: none;
            border-color: var(--axos-orange) !important;
            box-shadow: 0 0 0 3px rgba(250, 167, 74, 0.2);
        }
        
        .modal button:active {
            transform: scale(0.98);
        }
        
        /* Weekly Log styles */
        #weeklyLogEntries::-webkit-scrollbar {
            width: 6px;
        }
        #weeklyLogEntries::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        #weeklyLogEntries::-webkit-scrollbar-thumb {
            background: var(--axos-orange);
            border-radius: 3px;
        }
        
        .platform-log-btn {
            transition: all 0.2s ease;
        }
        .platform-log-btn:hover {
            transform: translateY(-1px);
        }
        
        /* Test entries list in modal */
        #testEntriesList::-webkit-scrollbar {
            width: 6px;
        }
        #testEntriesList::-webkit-scrollbar-track {
            background: #f8fafc;
        }
        #testEntriesList::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
    </style>
</head>
<body>

<div class="page-header">
    <h1>ğŸ“± Mobile Automation <span>Tracker</span></h1>
    <p><strong>Xebia Mobile Team</strong> â€” Android & iOS Regression | <span id="lastUpdated">Last Updated: -</span></p>
</div>

<div class="container">

    <div class="controls">
        <button class="btn-success" onclick="saveData()">ğŸ’¾ Save Changes</button>
        <button class="btn-primary" onclick="syncFromCloud()">â˜ï¸ Sync from Cloud</button>
        <button class="btn-warning" onclick="exportData()">ğŸ“¤ Export Data</button>
        <button class="btn-warning" onclick="importData()">ğŸ“¥ Import Data</button>
        <button class="btn-danger" onclick="resetData()">ğŸ”„ Reset to Default</button>
        <span id="saveStatus" class="save-status saved">âœ“ All changes saved</span>
        <span id="syncStatus" style="padding: 10px 16px; font-size: 12px; color: rgba(255,255,255,0.8); opacity: 0.7;">â˜ï¸ Cloud sync ready</span>
    </div>

    <div class="instructions">
        <h3>ğŸ“ How to Use</h3>
        <ul>
            <li><strong>Yellow cells</strong> are editable - click to edit, press Enter or click elsewhere to save</li>
            <li><strong>Green cells</strong> are auto-calculated based on your inputs</li>
            <li>Each week has <strong>Android</strong> (<svg style="width:14px;height:14px;vertical-align:middle;" viewBox="-147 -70 294 345" fill="#3ddc84"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg>) and <strong>iOS</strong> (<svg style="width:12px;height:12px;vertical-align:middle;" viewBox="0 0 814 1000" fill="#172b4d"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg>) columns</li>
            <li>The <strong>ğŸ Est. Finish</strong> updates automatically based on your actual progress</li>
            <li>Click <strong>Save Changes</strong> to persist your data (stored in browser)</li>
            <li>Use <strong>Export Data</strong> to download a backup JSON file</li>
        </ul>
    </div>

    <hr>

    <h2>ğŸ”— Overview</h2>
    
    <div style="display: flex; gap: 24px; flex-wrap: wrap; margin: 24px 0;">
        <!-- Android Overview -->
        <div style="flex: 1; min-width: 320px; border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(61, 220, 132, 0.2);">
            <div style="background: linear-gradient(135deg, #3ddc84 0%, #2ecc71 100%); color: #073042; padding: 16px 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; font-size: 1.1rem;">
                <svg style="width:20px;height:20px;" viewBox="-147 -70 294 345" fill="#073042"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg>
                Android
            </div>
            <table style="width: 100%; border-collapse: collapse; margin: 0;">
                <tr>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 600; width: 40%;">Status</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd;" id="overviewStatusAndroid">
                        <span class="status-badge on-track">â³ Not Started</span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 600;">Target Finish</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd;" id="overviewTargetAndroid">
                        <span style="color: #5e6c84;">â€” Based on weekly targets</span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 600;">Projected Completion</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd;" id="overviewProjectedAndroid">
                        <span style="color: #5e6c84;">â€” Based on actual pace</span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 16px; font-weight: 600;">Team</td>
                    <td style="padding: 10px 16px;">
                        <span style="background: #e3fcef; padding: 2px 8px; border-radius: 3px; margin-right: 4px;">@Rishabh Srivastava</span>
                        <span style="background: #e3fcef; padding: 2px 8px; border-radius: 3px; margin-right: 4px;">@Vijay Lachwani</span>
                        <span style="background: #e3fcef; padding: 2px 8px; border-radius: 3px;">@Jai Saxena</span>
                    </td>
                </tr>
            </table>
        </div>
        
        <!-- iOS Overview -->
        <div style="flex: 1; min-width: 320px; border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
            <div style="background: linear-gradient(135deg, #374151 0%, #1f2937 100%); color: white; padding: 16px 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; font-size: 1.1rem;">
                <svg style="width:16px;height:16px;" viewBox="0 0 814 1000" fill="white"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg>
                iOS
            </div>
            <table style="width: 100%; border-collapse: collapse; margin: 0;">
                <tr>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 600; width: 40%;">Status</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd;" id="overviewStatusIOS">
                        <span class="status-badge on-track">â³ Not Started</span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 600;">Target Finish</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd;" id="overviewTargetIOS">
                        <span style="color: #5e6c84;">â€” Based on weekly targets</span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 600;">Projected Completion</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd;" id="overviewProjectedIOS">
                        <span style="color: #5e6c84;">â€” Based on actual pace</span>
                    </td>
                </tr>
                <tr>
                    <td style="padding: 10px 16px; font-weight: 600;">Team</td>
                    <td style="padding: 10px 16px;">
                        <span style="background: #f4f5f7; padding: 2px 8px; border-radius: 3px; margin-right: 4px;">@Rishabh Srivastava</span>
                        <span style="background: #f4f5f7; padding: 2px 8px; border-radius: 3px; margin-right: 4px;">@Vijay Lachwani</span>
                        <span style="background: #f4f5f7; padding: 2px 8px; border-radius: 3px;">@Jai Saxena</span>
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <hr>

    <h2>ğŸ“‹ Progress Summary</h2>

    <!-- Android Section -->
    <div class="platform-section android">
        <h3><svg class="android-logo" viewBox="-147 -70 294 345" fill="#3ddc84"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg> Android Progress</h3>
    <div class="progress-summary">
            <div class="progress-stat editable-stat" onclick="editTotalScripts('android')">
                <div class="progress-stat-value" id="totalScriptsAndroid">367</div>
            <div class="progress-stat-label">Total Scripts âœï¸</div>
        </div>
        <div class="progress-stat auto">
                <div class="progress-stat-value" id="completedAndroid">0</div>
            <div class="progress-stat-label">Completed</div>
        </div>
        <div class="progress-stat auto">
                <div class="progress-stat-value" id="remainingAndroid">367</div>
            <div class="progress-stat-label">Remaining</div>
        </div>
        <div class="progress-stat auto">
                <div class="progress-stat-value" id="progressPercentAndroid">0%</div>
            <div class="progress-stat-label">Progress</div>
        </div>
        <div class="progress-stat auto">
                <div class="progress-stat-value" id="avgActualAndroid">~0</div>
                <div class="progress-stat-label">Avg/Week</div>
        </div>
        <div class="progress-stat auto">
                <div class="progress-stat-value" id="estFinishAndroid">-</div>
                <div class="progress-stat-label">ğŸ <svg style="width:10px;height:10px;vertical-align:middle;" viewBox="-147 -70 294 345" fill="#3ddc84"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg> Est. Finish</div>
            </div>
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progressBarFillAndroid" style="background: linear-gradient(90deg, #3ddc84 0%, #10b981 50%, #059669 100%); width: 0%;"></div>
            <span class="progress-bar-text" id="progressBarTextAndroid">0% Complete</span>
        </div>
    </div>

    <!-- iOS Section -->
    <div class="platform-section ios">
        <h3><svg style="width:16px;height:16px;vertical-align:middle;" viewBox="0 0 814 1000" fill="#000000"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg> iOS Progress</h3>
        <div class="progress-summary">
            <div class="progress-stat editable-stat" onclick="editTotalScripts('ios')">
                <div class="progress-stat-value" id="totalScriptsIOS">367</div>
                <div class="progress-stat-label">Total Scripts âœï¸</div>
            </div>
            <div class="progress-stat auto">
                <div class="progress-stat-value" id="completedIOS">0</div>
                <div class="progress-stat-label">Completed</div>
            </div>
            <div class="progress-stat auto">
                <div class="progress-stat-value" id="remainingIOS">367</div>
                <div class="progress-stat-label">Remaining</div>
            </div>
            <div class="progress-stat auto">
                <div class="progress-stat-value" id="progressPercentIOS">0%</div>
                <div class="progress-stat-label">Progress</div>
            </div>
            <div class="progress-stat auto">
                <div class="progress-stat-value" id="avgActualIOS">~0</div>
                <div class="progress-stat-label">Avg/Week</div>
            </div>
            <div class="progress-stat auto">
                <div class="progress-stat-value" id="estFinishIOS">-</div>
                <div class="progress-stat-label">ğŸ <svg style="width:10px;height:10px;vertical-align:middle;margin-top:-1px;" viewBox="0 0 814 1000" fill="#000"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg> Est. Finish</div>
            </div>
        </div>
    <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progressBarFillIOS" style="background: linear-gradient(90deg, #6b7280 0%, #374151 50%, #1f2937 100%); width: 0%;"></div>
            <span class="progress-bar-text" id="progressBarTextIOS">0% Complete</span>
        </div>
    </div>

    <!-- Combined Finish Estimate -->
    <div class="finish-estimate">
        <h3>ğŸ Projected Completion</h3>
        <div style="display: flex; justify-content: center; gap: 40px; flex-wrap: wrap;">
            <div>
                <div style="font-size: 14px; color: rgba(255,255,255,0.7); font-weight: 500;">ğŸ¤– Android</div>
                <div class="date" id="projectedFinishAndroid">-</div>
            </div>
            <div>
                <div style="font-size: 14px; color: rgba(255,255,255,0.7); font-weight: 500;"><svg style="width:14px;height:14px;vertical-align:middle;" viewBox="0 0 814 1000" fill="rgba(255,255,255,0.7)"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg> iOS</div>
                <div class="date" id="projectedFinishIOS">-</div>
            </div>
        </div>
    </div>

    <div class="legend">
        <div class="legend-item"><div class="legend-color" style="background: #fffae6; border: 2px solid #ff8b00;"></div> Editable (click to edit)</div>
        <div class="legend-item"><div class="legend-color" style="background: #e3fcef;"></div> Auto-calculated</div>
        <div class="legend-item"><div class="legend-color" style="background: #3ddc84;"></div> <svg style="width:12px;height:12px;vertical-align:middle;" viewBox="-147 -70 294 345" fill="#3ddc84"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg> Android</div>
        <div class="legend-item"><div class="legend-color" style="background: #000000;"></div> <svg style="width:12px;height:12px;vertical-align:middle;" viewBox="0 0 814 1000" fill="#172b4d"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg> iOS</div>
        <div class="legend-item"><div class="legend-color" style="background: #deebff;"></div> Ahead of Target</div>
        <div class="legend-item"><div class="legend-color" style="background: #ffebe6;"></div> Behind Target</div>
    </div>

    <hr>

    <h2>ğŸ“‹ Weekly Progress Tracker</h2>

    <div class="tracker-container">
        <table class="tracker-table" id="trackerTable">
            <!-- Table will be generated by JavaScript -->
        </table>
    </div>

    <hr>

    <h2>ğŸ“Š Key Metrics</h2>
    
    <div style="display: flex; gap: 24px; flex-wrap: wrap; margin: 24px 0;">
        <!-- Android Metrics -->
        <div style="flex: 1; min-width: 380px; border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(61, 220, 132, 0.2); background: white;">
            <div style="background: linear-gradient(135deg, #3ddc84 0%, #2ecc71 100%); color: #073042; padding: 16px 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; font-size: 1.1rem;">
                <svg style="width:20px;height:20px;" viewBox="-147 -70 294 345" fill="#073042"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg>
                Android Metrics
            </div>
            <table style="width: 100%; border-collapse: collapse; margin: 0; background: white;">
                <tr style="background: #f4f5f7;">
                    <th style="padding: 8px 12px; text-align: left; border-bottom: 1px solid #ddd; width: 40%;">Metric</th>
                    <th style="padding: 8px 12px; text-align: center; border-bottom: 1px solid #ddd; width: 25%;">Value</th>
                    <th style="padding: 8px 12px; text-align: left; border-bottom: 1px solid #ddd;">Details</th>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Team Daily Velocity</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 800; color: #1E3860; font-size: 1.1rem;" id="metricDailyVelocityAndroid">0</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">tests per workday (team of 3)</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Per Person Average</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 700; color: #1E3860;" id="metricPerPersonAndroid">0</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">tests per person per day</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Total Backlog</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 700; color: #1E3860;" id="metricBacklogAndroid">367</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">scripts (excluding Deep Link Routing)</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Weekly Output</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 700; color: #1E3860;" id="metricWeeklyOutputAndroid">0</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">tests per week</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; font-weight: 500;">Current Pace ETA</td>
                    <td style="padding: 12px 16px; text-align: center; font-weight: 700; color: #1E3860;" id="metricETAAndroid">-</td>
                    <td style="padding: 10px 12px; color: #5e6c84; font-size: 12px;" id="metricETADetailsAndroid">~0 workdays</td>
                </tr>
            </table>
        </div>
        
        <!-- iOS Metrics -->
        <div style="flex: 1; min-width: 380px; border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); background: white;">
            <div style="background: linear-gradient(135deg, #374151 0%, #1f2937 100%); color: white; padding: 16px 20px; font-weight: 700; display: flex; align-items: center; gap: 10px; font-size: 1.1rem;">
                <svg style="width:16px;height:16px;" viewBox="0 0 814 1000" fill="white"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg>
                iOS Metrics
            </div>
            <table style="width: 100%; border-collapse: collapse; margin: 0; background: white;">
                <tr style="background: #f4f5f7;">
                    <th style="padding: 8px 12px; text-align: left; border-bottom: 1px solid #ddd; width: 40%;">Metric</th>
                    <th style="padding: 8px 12px; text-align: center; border-bottom: 1px solid #ddd; width: 25%;">Value</th>
                    <th style="padding: 8px 12px; text-align: left; border-bottom: 1px solid #ddd;">Details</th>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Team Daily Velocity</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 800; color: #1E3860; font-size: 1.1rem;" id="metricDailyVelocityIOS">0</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">tests per workday (team of 3)</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Per Person Average</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 700; color: #1E3860;" id="metricPerPersonIOS">0</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">tests per person per day</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Total Backlog</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 700; color: #1E3860;" id="metricBacklogIOS">367</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">scripts (excluding Deep Link Routing)</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; font-weight: 500;">Weekly Output</td>
                    <td style="padding: 12px 16px; border-bottom: 1px solid #e2e8f0; text-align: center; font-weight: 700; color: #1E3860;" id="metricWeeklyOutputIOS">0</td>
                    <td style="padding: 10px 12px; border-bottom: 1px solid #ddd; color: #5e6c84; font-size: 12px;">tests per week</td>
                </tr>
                <tr>
                    <td style="padding: 10px 12px; font-weight: 500;">Current Pace ETA</td>
                    <td style="padding: 12px 16px; text-align: center; font-weight: 700; color: #1E3860;" id="metricETAIOS">-</td>
                    <td style="padding: 10px 12px; color: #5e6c84; font-size: 12px;" id="metricETADetailsIOS">~0 workdays</td>
                </tr>
            </table>
        </div>
    </div>

    <hr>

    <h2>ğŸ“± Backlog Breakdown by Vertical</h2>
    
    <div style="overflow-x: auto; margin: 24px 0; border-radius: 16px; box-shadow: 0 4px 12px rgba(30, 56, 96, 0.1);">
        <table id="backlogTable" style="width: 100%; border-collapse: collapse; min-width: 500px;">
            <thead>
                <tr style="background: linear-gradient(135deg, #1E3860 0%, #2A4A7A 100%); color: white;">
                    <th style="padding: 14px 16px; text-align: left; font-weight: 700; border: none;">Vertical</th>
                    <th style="padding: 14px 16px; text-align: center; font-weight: 700; border: none;">ğŸ”´ P0</th>
                    <th style="padding: 14px 16px; text-align: center; font-weight: 700; border: none;">ğŸŸ  P1</th>
                    <th style="padding: 14px 16px; text-align: center; font-weight: 700; border: none;">ğŸ”µ P2</th>
                    <th style="padding: 14px 16px; text-align: center; font-weight: 700; border: none;">Total</th>
                    <th style="padding: 14px 16px; text-align: center; font-weight: 700; border: none;">% of Backlog</th>
                </tr>
            </thead>
            <tbody>
                <tr data-vertical="login" style="background: #fff;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ” Login</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">2</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">9</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">1</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">12</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">3.3%</td>
                </tr>
                <tr data-vertical="registration" style="background: #f9f9f9;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ“ Registration</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">0</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">15</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">0</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">15</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">4.1%</td>
                </tr>
                <tr data-vertical="home" style="background: #fff;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ  Home</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">1</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">3</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">3</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">7</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">1.9%</td>
                </tr>
                <tr data-vertical="bank" style="background: #f9f9f9;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ¦ Bank</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">10</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">77</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">12</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">99</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #000; font-weight: 700; background: #fffae6;">27.0%</td>
                </tr>
                <tr data-vertical="borrow" style="background: #fff;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ’³ Borrow</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">24</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">19</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">9</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">52</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">14.2%</td>
                </tr>
                <tr data-vertical="invest" style="background: #f9f9f9;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ“ˆ Invest</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">7</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">42</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">44</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">93</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #000; font-weight: 700; background: #fffae6;">25.3%</td>
                </tr>
                <tr data-vertical="plan" style="background: #fff;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ“‹ Plan</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">0</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">17</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">33</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">50</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">13.6%</td>
                </tr>
                <tr data-vertical="mega-menu" style="background: #f9f9f9;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">â˜° Mega Menu</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">2</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">26</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">9</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">37</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">10.1%</td>
                </tr>
                <tr data-vertical="evo-chat" style="background: #fff;">
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; font-weight: 500;">ğŸ’¬ Evo Chat</td>
                    <td class="p0-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #de350b; font-weight: 600;">0</td>
                    <td class="p1-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #ff8b00; font-weight: 600;">0</td>
                    <td class="p2-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #1E3860; font-weight: 600;">2</td>
                    <td class="total-cell" style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; font-weight: 700;">2</td>
                    <td style="padding: 10px 16px; border-bottom: 1px solid #ddd; text-align: center; color: #5e6c84;">0.5%</td>
                </tr>
            </tbody>
            <tfoot>
                <tr style="background: linear-gradient(135deg, #1E3860 0%, #2A4A7A 100%); color: white; font-weight: 700;">
                    <td style="padding: 14px 16px; font-weight: 800; border: none;">TOTAL</td>
                    <td class="p0-total" style="padding: 14px 16px; text-align: center; border: none; font-weight: 700;">46</td>
                    <td class="p1-total" style="padding: 14px 16px; text-align: center; border: none; font-weight: 700;">208</td>
                    <td class="p2-total" style="padding: 14px 16px; text-align: center; border: none; font-weight: 700;">113</td>
                    <td class="grand-total" style="padding: 14px 16px; text-align: center; border: none; font-weight: 800; color: #FAA74A;">367</td>
                    <td style="padding: 14px 16px; text-align: center; border: none; font-weight: 700;">100%</td>
                </tr>
            </tfoot>
        </table>
    </div>
    
    <div style="display: flex; gap: 24px; flex-wrap: wrap; margin: 20px 0; font-size: 13px; padding: 16px; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 12px;">
        <div style="display: flex; align-items: center; gap: 8px;">
            <span style="display: inline-block; width: 16px; height: 16px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); border-radius: 50%; box-shadow: 0 2px 4px rgba(239, 68, 68, 0.3);"></span>
            <strong style="color: #1E3860;">P0</strong> <span style="color: #64748b;">- Critical (46 tests, 12.5%)</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px;">
            <span style="display: inline-block; width: 16px; height: 16px; background: linear-gradient(135deg, #FAA74A 0%, #f59e0b 100%); border-radius: 50%; box-shadow: 0 2px 4px rgba(250, 167, 74, 0.3);"></span>
            <strong style="color: #1E3860;">P1</strong> <span style="color: #64748b;">- High (208 tests, 56.7%)</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px;">
            <span style="display: inline-block; width: 16px; height: 16px; background: linear-gradient(135deg, #1E3860 0%, #2A4A7A 100%); border-radius: 50%; box-shadow: 0 2px 4px rgba(30, 56, 96, 0.3);"></span>
            <strong style="color: #1E3860;">P2</strong> <span style="color: #64748b;">- Medium (113 tests, 30.8%)</span>
        </div>
    </div>

    <hr>

    <h2>âš ï¸ Risks & âš¡ Accelerators</h2>
    
    <div style="display: flex; gap: 24px; flex-wrap: wrap; margin: 24px 0;">
        <!-- Risks -->
        <div style="flex: 1; min-width: 320px; border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.15);">
            <div style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; padding: 16px 20px; font-weight: 700; font-size: 1.1rem;">
                âš ï¸ Risks
            </div>
            <ul style="margin: 0; padding: 16px 16px 16px 36px; list-style: none;">
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">ğŸ”Œ</span>
                    Environment and data gaps causing test blockages
                </li>
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">ğŸ¢</span>
                    VDI slowness impacting development speed
                </li>
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">ğŸ“±</span>
                    App crashes or UI issues on specific flows
                </li>
                <li style="padding: 8px 0; position: relative;">
                    <span style="position: absolute; left: -24px;">â³</span>
                    Delayed feedback loops (2-3 days for issue resolution)
                </li>
            </ul>
        </div>
        
        <!-- Accelerators -->
        <div style="flex: 1; min-width: 320px; border: none; border-radius: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.15);">
            <div style="background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; padding: 16px 20px; font-weight: 700; font-size: 1.1rem;">
                âš¡ Accelerators
            </div>
            <ul style="margin: 0; padding: 16px 16px 16px 36px; list-style: none;">
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">ğŸ¤–</span>
                    AI markdown templates for script generation
                </li>
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">ğŸ“¦</span>
                    Shared test data packs for UAT and STG environments
                </li>
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">ğŸ””</span>
                    Daily unblock window with Axos contacts
                </li>
                <li style="padding: 8px 0; border-bottom: 1px solid #f4f5f7; position: relative;">
                    <span style="position: absolute; left: -24px;">âœ…</span>
                    Stricter PR review SLAs
                </li>
                <li style="padding: 8px 0; position: relative;">
                    <span style="position: absolute; left: -24px;">â™»ï¸</span>
                    Reuse-first design of page objects and steps
                </li>
            </ul>
        </div>
    </div>

    <hr>

    <!-- Hidden file input for import -->
    <input type="file" id="fileInput" accept=".json" style="display: none;" onchange="handleFileImport(event)">

    <hr>

    <h2>ğŸ“‹ Weekly Log</h2>
    <div id="weeklyLogContainer" style="margin: 24px 0;">
        <!-- Week Navigation -->
        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; padding: 12px 16px; background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-radius: 12px;">
            <button onclick="navigateWeeklyLog(-1)" style="padding: 8px 16px; border: none; border-radius: 8px; background: var(--axos-navy); color: white; cursor: pointer; font-weight: 600;">
                â—€ Prev Week
            </button>
            <div style="text-align: center; display: flex; flex-direction: column; align-items: center; gap: 6px;">
                <span id="weeklyLogLabel" style="font-weight: 700; color: var(--axos-navy); font-size: 14px;">Current Week</span>
                <button id="goToCurrentWeekBtn" onclick="goToCurrentWeek()" style="padding: 4px 12px; border: none; border-radius: 6px; background: #10b981; color: white; cursor: pointer; font-weight: 600; font-size: 11px; display: none;">
                    ğŸ“ Go to Current Week
                </button>
            </div>
            <button onclick="navigateWeeklyLog(1)" style="padding: 8px 16px; border: none; border-radius: 8px; background: var(--axos-navy); color: white; cursor: pointer; font-weight: 600;">
                Next Week â–¶
            </button>
        </div>
        
        <!-- Platform Toggle -->
        <div style="display: flex; gap: 8px; margin-bottom: 16px;">
            <button id="logPlatformAndroid" class="platform-log-btn active" onclick="setLogPlatform('android')" style="padding: 10px 20px; border: 2px solid #3ddc84; border-radius: 8px; background: #d1fae5; color: #065f46; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                <svg style="width:16px;height:16px;" viewBox="-147 -70 294 345" fill="#065f46"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/></svg> Android
            </button>
            <button id="logPlatformIOS" class="platform-log-btn" onclick="setLogPlatform('ios')" style="padding: 10px 20px; border: 2px solid #e2e8f0; border-radius: 8px; background: white; color: #374151; cursor: pointer; font-weight: 600; display: flex; align-items: center; gap: 6px;">
                <svg style="width:14px;height:14px;" viewBox="0 0 814 1000" fill="#374151"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2z"/></svg> iOS
            </button>
        </div>
        
        <!-- Warnings Section -->
        <div id="weeklyLogWarnings" style="display: none; margin-bottom: 16px; padding: 16px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b; border-radius: 12px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <strong style="color: #92400e; font-size: 14px;">âš ï¸ Duplicate Entries Found</strong>
                <button onclick="showDuplicateDetailsModal()" style="padding: 6px 14px; background: #dc2626; border: none; border-radius: 6px; color: white; font-weight: 600; font-size: 12px; cursor: pointer;">
                    ğŸ” View Details & Remove
                </button>
            </div>
            <div id="warningsList" style="color: #92400e; font-size: 13px;"></div>
        </div>
        
        <!-- Log Entries -->
        <div id="weeklyLogEntries" style="max-height: 600px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 12px; background: white;">
            <p style="color: #64748b; text-align: center; padding: 40px;">No entries for this week. Click on an "Actual" cell to add test entries.</p>
        </div>
    </div>
</div>

<!-- Test Entry Modal -->
<div class="modal-overlay" id="testEntryModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000; opacity: 0; visibility: hidden; transition: all 0.3s ease;">
    <div class="modal" style="background: white; border-radius: 20px; padding: 0; width: 800px; max-width: 95%; max-height: 90vh; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.3); transform: translateY(-20px); transition: transform 0.3s ease;">
        <!-- Modal Header -->
        <div style="background: var(--gradient-navy); color: white; padding: 20px 24px; display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h3 style="margin: 0; font-size: 1.25rem;" id="modalTitle">ğŸ“ Enter Weekly Tests</h3>
                <p style="margin: 4px 0 0 0; font-size: 12px; opacity: 0.8;" id="modalSubtitle">Week X - Platform</p>
            </div>
            <button onclick="closeTestEntryModal()" style="background: rgba(255,255,255,0.1); border: none; color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 18px;">âœ•</button>
        </div>
        
        <!-- Modal Body -->
        <div style="padding: 24px; max-height: calc(90vh - 180px); overflow-y: auto;">
            <!-- Total Summary -->
            <div style="display: flex; gap: 16px; margin-bottom: 24px; padding: 16px; background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); border-radius: 12px; border: 2px solid #10b981; flex-wrap: wrap;">
                <div style="flex: 1; text-align: center; min-width: 80px;">
                    <div style="font-size: 32px; font-weight: 800; color: var(--axos-navy);" id="modalTotalCount">0</div>
                    <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">Total Tests</div>
                </div>
                <div style="flex: 1; text-align: center; border-left: 1px solid #a7f3d0; padding-left: 16px; min-width: 80px;">
                    <div style="font-size: 24px; font-weight: 700; color: #3ddc84;" id="modalAndroidCount">0</div>
                    <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">ğŸ¤– Android</div>
                </div>
                <div style="flex: 1; text-align: center; border-left: 1px solid #a7f3d0; padding-left: 16px; min-width: 80px;">
                    <div style="font-size: 24px; font-weight: 700; color: #374151;" id="modalIOSCount">0</div>
                    <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">ğŸ iOS</div>
                </div>
                <div style="flex: 2; text-align: center; border-left: 1px solid #a7f3d0; padding-left: 16px; min-width: 150px;">
                    <div style="font-size: 14px; font-weight: 600; color: var(--axos-navy);" id="modalEngineerBreakdown">-</div>
                    <div style="font-size: 11px; color: #64748b; text-transform: uppercase; letter-spacing: 0.5px;">Per Engineer</div>
                </div>
            </div>
            
            <!-- Entry Method Toggle -->
            <div style="display: flex; gap: 0; margin-bottom: 20px; border-radius: 12px; overflow: hidden; border: 2px solid #e2e8f0;">
                <button id="tabImport" onclick="setEntryMethod('import')" style="flex: 1; padding: 14px 20px; border: none; cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.2s; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white;">
                    ğŸ“¥ Import from Daily Tracker
                </button>
                <button id="tabManual" onclick="setEntryMethod('manual')" style="flex: 1; padding: 14px 20px; border: none; cursor: pointer; font-weight: 600; font-size: 14px; transition: all 0.2s; background: #f8fafc; color: #64748b;">
                    âœï¸ Manual Entry
                </button>
            </div>
            
            <!-- Import Section (Default/Primary) -->
            <div id="importSection" style="background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid #10b981;">
                <h4 style="margin: 0 0 16px 0; color: var(--axos-navy); display: flex; align-items: center; gap: 8px;">
                    ğŸ“¥ Import from Daily Tracker
                    <span style="font-size: 11px; font-weight: 500; color: #065f46; background: rgba(255,255,255,0.5); padding: 4px 10px; border-radius: 20px;">Recommended</span>
                </h4>
                <p style="margin: 0 0 16px 0; font-size: 13px; color: #065f46;">
                    Export completed tests from <strong>Daily Tracker</strong> and paste the JSON data below to automatically import them.
                </p>
                <div style="margin-bottom: 12px;">
                    <label style="display: block; font-size: 12px; font-weight: 600; color: var(--axos-navy); margin-bottom: 6px;">
                        ğŸ“‹ Paste exported data from Daily Tracker
                    </label>
                    <textarea id="dailyTrackerImportData" placeholder='Paste the JSON exported from Daily Tracker here...' style="width: 100%; height: 120px; padding: 10px; border: 2px solid #a7f3d0; border-radius: 8px; font-family: monospace; font-size: 11px; resize: vertical; box-sizing: border-box; background: white;"></textarea>
                </div>
                <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                    <button onclick="importFromDailyTracker()" style="padding: 12px 24px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer; font-size: 14px;">
                        âœ… Import Tests
                    </button>
                </div>
                <div style="margin-top: 16px; padding: 12px; background: rgba(255,255,255,0.6); border-radius: 8px;">
                    <p style="margin: 0; font-size: 12px; color: #065f46;">
                        <strong>ğŸ’¡ How to get the data:</strong><br>
                        1. Open Daily Tracker<br>
                        2. Click <strong>"âœ… Completed This Week"</strong> filter in Test Inventory<br>
                        3. Click <strong>"ğŸ“¤ Export for Tracker"</strong> button<br>
                        4. Copy the data and paste it above
                    </p>
                </div>
            </div>
            
            <!-- Manual Entry Section (Hidden by default) -->
            <div id="manualSection" style="background: #f8fafc; padding: 20px; border-radius: 12px; margin-bottom: 20px; display: none;">
                <h4 style="margin: 0 0 16px 0; color: var(--axos-navy); display: flex; align-items: center; gap: 8px;">
                    âœï¸ Add New Test Manually
                </h4>
                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 180px;">
                        <label style="display: block; font-size: 11px; font-weight: 600; color: var(--axos-navy); margin-bottom: 4px; text-transform: uppercase;">Engineer</label>
                        <select id="testEngineer" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
                            <!-- Options populated by JS -->
                        </select>
                    </div>
                    <div style="flex: 2; min-width: 200px;">
                        <label style="display: block; font-size: 11px; font-weight: 600; color: var(--axos-navy); margin-bottom: 4px; text-transform: uppercase;">Test Name</label>
                        <input type="text" id="testName" placeholder="e.g., Login - Biometric Authentication" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; box-sizing: border-box;">
                    </div>
                    <div style="flex: 1; min-width: 180px;">
                        <label style="display: block; font-size: 11px; font-weight: 600; color: var(--axos-navy); margin-bottom: 4px; text-transform: uppercase;">ADO Task # or URL</label>
                        <input type="text" id="testAdoId" placeholder="ID or full URL" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; box-sizing: border-box;" title="Enter ADO ID (e.g., 2194282) or paste the full URL">
                    </div>
                </div>
                <div style="display: flex; gap: 12px; margin-top: 12px; flex-wrap: wrap;">
                    <div style="flex: 1; min-width: 140px;">
                        <label style="display: block; font-size: 11px; font-weight: 600; color: var(--axos-navy); margin-bottom: 4px; text-transform: uppercase;">Platform</label>
                        <select id="testPlatform" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px; background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);">
                            <option value="both">ğŸ“± Both</option>
                            <option value="android">ğŸ¤– Android</option>
                            <option value="ios">ğŸ iOS</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 150px;">
                        <label style="display: block; font-size: 11px; font-weight: 600; color: var(--axos-navy); margin-bottom: 4px; text-transform: uppercase;">Vertical</label>
                        <select id="testVertical" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
                            <option value="login">ğŸ” Login</option>
                            <option value="registration">ğŸ“ Registration</option>
                            <option value="home">ğŸ  Home</option>
                            <option value="bank">ğŸ¦ Bank</option>
                            <option value="borrow">ğŸ’³ Borrow</option>
                            <option value="invest">ğŸ“ˆ Invest</option>
                            <option value="plan">ğŸ“‹ Plan</option>
                            <option value="mega-menu">â˜° Mega Menu</option>
                            <option value="evo-chat">ğŸ’¬ Evo Chat</option>
                        </select>
                    </div>
                    <div style="flex: 1; min-width: 150px;">
                        <label style="display: block; font-size: 11px; font-weight: 600; color: var(--axos-navy); margin-bottom: 4px; text-transform: uppercase;">Priority</label>
                        <select id="testPriority" style="width: 100%; padding: 10px 12px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 14px;">
                            <option value="P0">ğŸ”´ P0 - Critical</option>
                            <option value="P1" selected>ğŸŸ  P1 - High</option>
                            <option value="P2">ğŸ”µ P2 - Medium</option>
                        </select>
                    </div>
                    <div style="flex: 0; display: flex; align-items: flex-end;">
                        <button onclick="addTestEntry()" style="padding: 10px 24px; background: var(--gradient-orange); border: none; border-radius: 8px; color: var(--axos-navy); font-weight: 600; cursor: pointer; white-space: nowrap;">
                            â• Add Test
                        </button>
                    </div>
                </div>
                <!-- Add New Engineer -->
                <div style="margin-top: 12px; padding-top: 12px; border-top: 1px dashed #e2e8f0;">
                    <button onclick="showAddEngineerForm()" id="addEngineerBtn" style="padding: 6px 12px; background: white; border: 1px solid #e2e8f0; border-radius: 6px; color: #64748b; font-size: 12px; cursor: pointer;">
                        ğŸ‘¤ Add New Engineer
                    </button>
                    <div id="addEngineerForm" style="display: none; margin-top: 8px;">
                        <div style="display: flex; gap: 8px;">
                            <input type="text" id="newEngineerName" placeholder="Engineer name" style="flex: 1; padding: 8px 12px; border: 2px solid #e2e8f0; border-radius: 6px; font-size: 13px;">
                            <button onclick="addNewEngineer()" style="padding: 8px 16px; background: #10b981; border: none; border-radius: 6px; color: white; font-weight: 600; cursor: pointer;">Add</button>
                            <button onclick="hideAddEngineerForm()" style="padding: 8px 12px; background: #fee2e2; border: none; border-radius: 6px; color: #dc2626; cursor: pointer;">âœ•</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Test Entries List -->
            <div>
                <h4 style="margin: 0 0 12px 0; color: var(--axos-navy); display: flex; align-items: center; justify-content: space-between;">
                    <span>ğŸ“‹ Test Entries</span>
                    <span style="font-size: 12px; color: #64748b; font-weight: 500;" id="entriesCount">0 entries</span>
                </h4>
                <div id="testEntriesList" style="border: 1px solid #e2e8f0; border-radius: 8px; max-height: 300px; overflow-y: auto;">
                    <p style="color: #64748b; text-align: center; padding: 24px; margin: 0;">No tests added yet. Use the form above to add tests.</p>
                </div>
            </div>
        </div>
        
        <!-- Modal Footer -->
        <div style="padding: 16px 24px; background: #f8fafc; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
            <div style="font-size: 13px; color: #64748b;">
                <span id="modalSaveHint">Changes will be saved when you click Save</span>
            </div>
            <div style="display: flex; gap: 12px;">
                <button onclick="closeTestEntryModal()" style="padding: 10px 20px; background: #fee2e2; border: none; border-radius: 8px; color: #dc2626; font-weight: 600; cursor: pointer;">Cancel</button>
                <button onclick="saveTestEntries()" style="padding: 10px 24px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer;">ğŸ’¾ Save Tests</button>
            </div>
        </div>
    </div>
</div>

<!-- Signature Footer -->
<footer style="
    background: linear-gradient(135deg, var(--axos-navy) 0%, var(--axos-navy-dark) 100%);
    padding: 32px 24px;
    text-align: center;
    margin-top: 0;
    position: relative;
    overflow: hidden;
">
    <div style="
        position: absolute;
        top: -50%;
        left: -10%;
        width: 300px;
        height: 300px;
        background: radial-gradient(circle, rgba(250, 167, 74, 0.1) 0%, transparent 70%);
        border-radius: 50%;
    "></div>
    <div style="
        position: absolute;
        bottom: -30%;
        right: 5%;
        width: 200px;
        height: 200px;
        background: radial-gradient(circle, rgba(250, 167, 74, 0.08) 0%, transparent 70%);
        border-radius: 50%;
    "></div>
    
    <div style="position: relative; z-index: 1;">
        <div style="
            display: inline-flex;
            align-items: center;
            gap: 12px;
            background: rgba(255,255,255,0.05);
            padding: 16px 28px;
            border-radius: 50px;
            border: 1px solid rgba(250, 167, 74, 0.3);
            margin-bottom: 16px;
        ">
            <span style="font-size: 24px;">ğŸ§ ğŸ’»</span>
            <span style="color: rgba(255,255,255,0.9); font-size: 14px; font-weight: 500;">
                Crafted in <span style="color: var(--axos-orange); font-weight: 700;">Cursor AI</span>
            </span>
        </div>
        
        <p style="
            color: rgba(255,255,255,0.7);
            font-size: 13px;
            margin: 12px 0;
            line-height: 1.6;
        ">
            with the invaluable guidance of our primal ğŸ¦ (a.k.a. human) companion:
        </p>
        
        <p style="
            color: white;
            font-size: 16px;
            font-weight: 700;
            margin: 8px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        ">
            <span style="font-size: 20px;">ğŸ‘¤</span>
            <span style="
                background: linear-gradient(90deg, var(--axos-orange), #fbbf24);
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
            ">Juan Carlos Martinez Toledo</span>
        </p>
        
        <p style="
            color: var(--axos-orange);
            font-size: 13px;
            font-style: italic;
            margin-top: 16px;
            opacity: 0.9;
        ">
            "Spotted by human intuition, created by AI precision!" ğŸ¯
        </p>
        
        <div style="
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid rgba(255,255,255,0.1);
        ">
            <span style="
                color: rgba(255,255,255,0.4);
                font-size: 11px;
                letter-spacing: 1px;
            ">
                XEBIA Ã— AXOS BANK â€¢ MOBILE AUTOMATION TEAM â€¢ 2025-2026
            </span>
        </div>
    </div>
</footer>

<script>
    // ========================================
    // GOOGLE SHEETS INTEGRATION
    // Replace this URL with your deployed Google Apps Script Web App URL
    // ========================================
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw-qOJvpA3WfzKvaYS30pH5iCEx3iNUNF9MEwCmzAgg1ofP8egqxShKue-HnVq3o9UFQQ/exec';
    
    // Configuration
    const CONFIG = {
        totalScriptsAndroid: 367,
        totalScriptsIOS: 367,
        startWeek: 52,
        startYear: 2025,
        totalWeeks: 52, // W52 2025 to W52 2026 (full year)
        defaultWeeklyTarget: 15, // Default weekly target
        maxDeadlineWeekIdx: 51 // W52 Dec 2026 (last index in WEEKS array)
    };

    // Week definitions with dates (Starting Week 52, Dec 22-26, 2025 through Dec 2026)
    const WEEKS = [
        // December 2025
        { week: 52, month: 'Dec 2025', dates: '22-26', year: 2025, current: true },
        // January 2026
        { week: 1, month: 'Jan 2026', dates: '29-2', year: 2026 },
        { week: 2, month: 'Jan 2026', dates: '5-9', year: 2026 },
        { week: 3, month: 'Jan 2026', dates: '12-16', year: 2026 },
        { week: 4, month: 'Jan 2026', dates: '19-23', year: 2026 },
        { week: 5, month: 'Jan 2026', dates: '26-30', year: 2026 },
        // February 2026
        { week: 6, month: 'Feb 2026', dates: '2-6', year: 2026 },
        { week: 7, month: 'Feb 2026', dates: '9-13', year: 2026 },
        { week: 8, month: 'Feb 2026', dates: '16-20', year: 2026 },
        { week: 9, month: 'Feb 2026', dates: '23-27', year: 2026 },
        // March 2026
        { week: 10, month: 'Mar 2026', dates: '2-6', year: 2026 },
        { week: 11, month: 'Mar 2026', dates: '9-13', year: 2026 },
        { week: 12, month: 'Mar 2026', dates: '16-20', year: 2026 },
        { week: 13, month: 'Mar 2026', dates: '23-27', year: 2026 },
        { week: 14, month: 'Mar 2026', dates: '30-3', year: 2026 },
        // April 2026
        { week: 15, month: 'Apr 2026', dates: '6-10', year: 2026 },
        { week: 16, month: 'Apr 2026', dates: '13-17', year: 2026 },
        { week: 17, month: 'Apr 2026', dates: '20-24', year: 2026 },
        { week: 18, month: 'Apr 2026', dates: '27-1', year: 2026 },
        // May 2026
        { week: 19, month: 'May 2026', dates: '4-8', year: 2026 },
        { week: 20, month: 'May 2026', dates: '11-15', year: 2026 },
        { week: 21, month: 'May 2026', dates: '18-22', year: 2026 },
        { week: 22, month: 'May 2026', dates: '25-29', year: 2026 },
        // June 2026
        { week: 23, month: 'Jun 2026', dates: '1-5', year: 2026 },
        { week: 24, month: 'Jun 2026', dates: '8-12', year: 2026 },
        { week: 25, month: 'Jun 2026', dates: '15-19', year: 2026 },
        { week: 26, month: 'Jun 2026', dates: '22-26', year: 2026 },
        { week: 27, month: 'Jun 2026', dates: '29-3', year: 2026 },
        // July 2026
        { week: 28, month: 'Jul 2026', dates: '6-10', year: 2026 },
        { week: 29, month: 'Jul 2026', dates: '13-17', year: 2026 },
        { week: 30, month: 'Jul 2026', dates: '20-24', year: 2026 },
        { week: 31, month: 'Jul 2026', dates: '27-31', year: 2026 },
        // August 2026
        { week: 32, month: 'Aug 2026', dates: '3-7', year: 2026 },
        { week: 33, month: 'Aug 2026', dates: '10-14', year: 2026 },
        { week: 34, month: 'Aug 2026', dates: '17-21', year: 2026 },
        { week: 35, month: 'Aug 2026', dates: '24-28', year: 2026 },
        { week: 36, month: 'Aug 2026', dates: '31-4', year: 2026 },
        // September 2026
        { week: 37, month: 'Sep 2026', dates: '7-11', year: 2026 },
        { week: 38, month: 'Sep 2026', dates: '14-18', year: 2026 },
        { week: 39, month: 'Sep 2026', dates: '21-25', year: 2026 },
        { week: 40, month: 'Sep 2026', dates: '28-2', year: 2026 },
        // October 2026
        { week: 41, month: 'Oct 2026', dates: '5-9', year: 2026 },
        { week: 42, month: 'Oct 2026', dates: '12-16', year: 2026 },
        { week: 43, month: 'Oct 2026', dates: '19-23', year: 2026 },
        { week: 44, month: 'Oct 2026', dates: '26-30', year: 2026 },
        // November 2026
        { week: 45, month: 'Nov 2026', dates: '2-6', year: 2026 },
        { week: 46, month: 'Nov 2026', dates: '9-13', year: 2026 },
        { week: 47, month: 'Nov 2026', dates: '16-20', year: 2026 },
        { week: 48, month: 'Nov 2026', dates: '23-27', year: 2026 },
        { week: 49, month: 'Nov 2026', dates: '30-4', year: 2026 },
        // December 2026
        { week: 50, month: 'Dec 2026', dates: '7-11', year: 2026 },
        { week: 51, month: 'Dec 2026', dates: '14-18', year: 2026 },
        { week: 52, month: 'Dec 2026', dates: '21-25', year: 2026 }
    ];

    // Data storage
    let data = {
        totalScriptsAndroid: CONFIG.totalScriptsAndroid,
        totalScriptsIOS: CONFIG.totalScriptsIOS,
        android: {
            weeklyTargets: {},
            weeklyActuals: {},
            weeklyEntries: {} // { weekKey: [{ id, engineer, testName, adoId, vertical, priority, timestamp }] }
        },
        ios: {
            weeklyTargets: {},
            weeklyActuals: {},
            weeklyEntries: {}
        },
        engineers: [
            { id: 'rishabh', name: 'Rishabh Srivastava' },
            { id: 'vijay', name: 'Vijay Lachwani' },
            { id: 'jai', name: 'Jai Saxena' }
        ],
        lastUpdated: new Date().toISOString()
    };
    
    // Backlog data (static baseline)
    const BACKLOG_BASELINE = {
        'login': { P0: 2, P1: 9, P2: 1, total: 12, emoji: 'ğŸ”', name: 'Login' },
        'registration': { P0: 0, P1: 15, P2: 0, total: 15, emoji: 'ğŸ“', name: 'Registration' },
        'home': { P0: 1, P1: 3, P2: 3, total: 7, emoji: 'ğŸ ', name: 'Home' },
        'bank': { P0: 10, P1: 77, P2: 12, total: 99, emoji: 'ğŸ¦', name: 'Bank' },
        'borrow': { P0: 24, P1: 19, P2: 9, total: 52, emoji: 'ğŸ’³', name: 'Borrow' },
        'invest': { P0: 7, P1: 42, P2: 44, total: 93, emoji: 'ğŸ“ˆ', name: 'Invest' },
        'plan': { P0: 0, P1: 17, P2: 33, total: 50, emoji: 'ğŸ“‹', name: 'Plan' },
        'mega-menu': { P0: 2, P1: 26, P2: 9, total: 37, emoji: 'â˜°', name: 'Mega Menu' },
        'evo-chat': { P0: 0, P1: 0, P2: 2, total: 2, emoji: 'ğŸ’¬', name: 'Evo Chat' }
    };
    
    // Modal state
    let currentModalWeekKey = null;
    let tempTestEntries = []; // Now stores entries for BOTH platforms
    
    // Weekly log state
    let weeklyLogWeekIdx = 0; // Index into WEEKS array
    let weeklyLogPlatform = 'android';
    let currentWeekIdx = 0; // The actual current week index based on today's date
    
    // Find the current week index based on today's date
    function findCurrentWeekIndex() {
        const today = new Date();
        today.setHours(12, 0, 0, 0); // Normalize to noon to avoid timezone issues
        
        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        for (let i = 0; i < WEEKS.length; i++) {
            const week = WEEKS[i];
            const weekYear = week.year;
            const weekMonthName = week.month.split(' ')[0];
            const weekMonthIdx = monthNames.indexOf(weekMonthName);
            
            // Parse the dates (e.g., "22-26" or "29-2")
            const dateParts = week.dates.split('-');
            const startDay = parseInt(dateParts[0]);
            const endDay = parseInt(dateParts[1]);
            
            // Handle week spanning two months (e.g., "29-2" means prev month 29 to current month 2)
            let weekStartDate, weekEndDate;
            
            if (endDay < startDay) {
                // Week spans two months - the month label is for the END of the week
                // So start is in the PREVIOUS month
                const prevMonth = weekMonthIdx - 1;
                const prevYear = prevMonth < 0 ? weekYear - 1 : weekYear;
                const actualPrevMonth = prevMonth < 0 ? 11 : prevMonth;
                
                weekStartDate = new Date(prevYear, actualPrevMonth, startDay);
                weekEndDate = new Date(weekYear, weekMonthIdx, endDay);
            } else {
                weekStartDate = new Date(weekYear, weekMonthIdx, startDay);
                weekEndDate = new Date(weekYear, weekMonthIdx, endDay);
            }
            
            // Extend end date to end of day
            weekEndDate.setHours(23, 59, 59, 999);
            weekStartDate.setHours(0, 0, 0, 0);
            
            // Check if today falls within this week
            if (today >= weekStartDate && today <= weekEndDate) {
                return i;
            }
        }
        
        // If no exact match, find the closest week
        // First check if we're before the first week
        const firstWeek = WEEKS[0];
        const firstWeekMonth = monthNames.indexOf(firstWeek.month.split(' ')[0]);
        const firstDates = firstWeek.dates.split('-');
        const firstStartDay = parseInt(firstDates[0]);
        const firstEndDay = parseInt(firstDates[1]);
        
        let firstWeekStart;
        if (firstEndDay < firstStartDay) {
            // First week spans months
            const prevMonth = firstWeekMonth - 1;
            const prevYear = prevMonth < 0 ? firstWeek.year - 1 : firstWeek.year;
            firstWeekStart = new Date(prevYear, prevMonth < 0 ? 11 : prevMonth, firstStartDay);
        } else {
            firstWeekStart = new Date(firstWeek.year, firstWeekMonth, firstStartDay);
        }
        
        if (today < firstWeekStart) {
            return 0; // Before timeline starts, show first week
        }
        
        // We're past the last week, return the last one
        return WEEKS.length - 1;
    }
    
    // Go to the current week
    function goToCurrentWeek() {
        weeklyLogWeekIdx = currentWeekIdx;
        renderWeeklyLog();
        updateGoToCurrentWeekButton();
    }
    
    // Update the visibility of the "Go to Current Week" button
    function updateGoToCurrentWeekButton() {
        const btn = document.getElementById('goToCurrentWeekBtn');
        if (btn) {
            // Show button only if we're not on the current week
            btn.style.display = weeklyLogWeekIdx !== currentWeekIdx ? 'inline-block' : 'none';
        }
    }

    // Initialize default values
    function initializeDefaults() {
        // Ensure weeklyEntries objects exist
        if (!data.android.weeklyEntries) data.android.weeklyEntries = {};
        if (!data.ios.weeklyEntries) data.ios.weeklyEntries = {};
        
        // Ensure engineers array exists with defaults
        if (!data.engineers || !Array.isArray(data.engineers)) {
            data.engineers = [
                { id: 'rishabh', name: 'Rishabh Srivastava' },
                { id: 'vijay', name: 'Vijay Lachwani' },
                { id: 'jai', name: 'Jai Saxena' }
            ];
        }
        
        WEEKS.forEach((w, idx) => {
            const key = `${w.year}-W${w.week}`;
            
            // Android
            if (data.android.weeklyTargets[key] === undefined) {
                data.android.weeklyTargets[key] = CONFIG.defaultWeeklyTarget;
            }
            if (data.android.weeklyActuals[key] === undefined) {
                data.android.weeklyActuals[key] = null;
            }
            if (data.android.weeklyEntries[key] === undefined) {
                data.android.weeklyEntries[key] = [];
            }
            
            // iOS
            if (data.ios.weeklyTargets[key] === undefined) {
                data.ios.weeklyTargets[key] = CONFIG.defaultWeeklyTarget;
            }
            if (data.ios.weeklyActuals[key] === undefined) {
                data.ios.weeklyActuals[key] = null;
            }
            if (data.ios.weeklyEntries[key] === undefined) {
                data.ios.weeklyEntries[key] = [];
            }
        });
    }

    // Check if data has valid structure
    function isValidData(d) {
        return d && d.android && d.ios && 
               typeof d.android.weeklyTargets === 'object' && 
               typeof d.android.weeklyActuals === 'object';
    }
    
    // Load data from Google Sheets (with localStorage fallback)
    async function loadData() {
        // Try Google Sheets first
        if (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL !== 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
            try {
                showSyncStatus('Loading from cloud...');
                const response = await fetch(GOOGLE_SCRIPT_URL);
                const result = await response.json();
                
                if (result.success && isValidData(result.data)) {
                    data = result.data;
                    initializeDefaults();
                    // Also save to localStorage as cache
                    localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
                    showSyncStatus('âœ… Synced from cloud');
                    updateLastUpdated();
                    return;
                } else {
                    showSyncStatus('â˜ï¸ No cloud data yet');
                }
            } catch (e) {
                console.error('Error loading from Google Sheets:', e);
                showSyncStatus('âš ï¸ Cloud unavailable, using local');
            }
        }
        
        // Fallback to localStorage
        const saved = localStorage.getItem('mobileAutomationTrackerDual');
        if (saved) {
            try {
                data = JSON.parse(saved);
                initializeDefaults();
            } catch (e) {
                console.error('Error loading data:', e);
                initializeDefaults();
            }
        } else {
            initializeDefaults();
        }
        updateLastUpdated();
    }

    // Save data to Google Sheets (and localStorage)
    async function saveData() {
        data.lastUpdated = new Date().toISOString();
        
        // Always save to localStorage first
        localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
        updateLastUpdated();
        
        // Save to Google Sheets if configured
        if (GOOGLE_SCRIPT_URL && GOOGLE_SCRIPT_URL !== 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
            try {
                showSyncStatus('Saving to cloud...');
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        data: data,
                        updatedBy: 'Weekly Tracker User',
                        action: 'save'
                    })
                });
                showSyncStatus('âœ… Saved to cloud');
                showSaveStatus(true);
                alert('âœ… Data saved to cloud successfully!');
            } catch (e) {
                console.error('Error saving to Google Sheets:', e);
                showSyncStatus('âš ï¸ Saved locally only');
                showSaveStatus(true);
                alert('âœ… Data saved locally (cloud sync failed)');
            }
        } else {
            showSaveStatus(true);
            alert('âœ… Data saved locally! (Configure Google Sheets for team sync)');
        }
    }
    
    // Sync from cloud manually
    async function syncFromCloud() {
        if (!GOOGLE_SCRIPT_URL || GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_SCRIPT_URL_HERE') {
            alert('âš ï¸ Google Sheets not configured. See setup instructions.');
            return;
        }
        
        try {
            showSyncStatus('Syncing...');
            const response = await fetch(GOOGLE_SCRIPT_URL);
            const result = await response.json();
            
            if (result.success && isValidData(result.data)) {
                data = result.data;
                initializeDefaults();
                localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
                renderTable();
                updateSummary();
                renderWeeklyLog();
                updateBacklogBreakdown();
                showSyncStatus('âœ… Synced from cloud');
                alert('âœ… Data synced from cloud!');
            } else {
                showSyncStatus('â˜ï¸ No cloud data yet');
                alert('â„¹ï¸ No saved data in cloud yet. Save your data first to sync it to the cloud!');
            }
        } catch (e) {
            console.error('Sync error:', e);
            showSyncStatus('âŒ Sync failed');
            alert('âŒ Failed to sync from cloud: ' + e.message);
        }
    }
    
    function showSyncStatus(message) {
        const statusEl = document.getElementById('syncStatus');
        if (statusEl) {
            statusEl.textContent = message;
            statusEl.style.opacity = '1';
            setTimeout(() => { statusEl.style.opacity = '0.7'; }, 2000);
        }
    }

    // Export data as JSON
    function exportData() {
        const dataStr = JSON.stringify(data, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `mobile-automation-tracker-dual-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
    }

    // Import data from JSON
    function importData() {
        document.getElementById('fileInput').click();
    }

    function handleFileImport(event) {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const imported = JSON.parse(e.target.result);
                    data = imported;
                    initializeDefaults();
                    saveData();
                    renderTable();
                    updateSummary();
                    renderWeeklyLog();
                    updateBacklogBreakdown();
                    alert('âœ… Data imported successfully!');
                } catch (err) {
                    alert('âŒ Error importing data: Invalid JSON file');
                }
            };
            reader.readAsText(file);
        }
    }

    // Reset to default
    function resetData() {
        if (confirm('âš ï¸ Are you sure you want to reset all data? This cannot be undone.')) {
            localStorage.removeItem('mobileAutomationTrackerDual');
            data = {
                totalScriptsAndroid: CONFIG.totalScriptsAndroid,
                totalScriptsIOS: CONFIG.totalScriptsIOS,
                android: {
                    weeklyTargets: {},
                    weeklyActuals: {},
                    weeklyEntries: {}
                },
                ios: {
                    weeklyTargets: {},
                    weeklyActuals: {},
                    weeklyEntries: {}
                },
                engineers: [
                    { id: 'rishabh', name: 'Rishabh Srivastava' },
                    { id: 'vijay', name: 'Vijay Lachwani' },
                    { id: 'jai', name: 'Jai Saxena' }
                ],
                lastUpdated: new Date().toISOString()
            };
            WEEKS.forEach((w, idx) => {
                const key = `${w.year}-W${w.week}`;
                data.android.weeklyTargets[key] = CONFIG.defaultWeeklyTarget;
                data.android.weeklyActuals[key] = null;
                data.android.weeklyEntries[key] = [];
                data.ios.weeklyTargets[key] = CONFIG.defaultWeeklyTarget;
                data.ios.weeklyActuals[key] = null;
                data.ios.weeklyEntries[key] = [];
            });
            saveData();
            renderTable();
            updateSummary();
            renderWeeklyLog();
            updateBacklogBreakdown();
        }
    }

    // Update last updated display
    function updateLastUpdated() {
        const date = new Date(data.lastUpdated);
        document.getElementById('lastUpdated').textContent = 
            `Last Updated: ${date.toLocaleDateString()} ${date.toLocaleTimeString()}`;
    }

    // Show save status
    function showSaveStatus(saved) {
        const status = document.getElementById('saveStatus');
        if (saved) {
            status.className = 'save-status saved';
            status.textContent = 'âœ“ All changes saved';
        } else {
            status.className = 'save-status unsaved';
            status.textContent = 'âš  Unsaved changes';
        }
    }

    // Bulk edit all targets
    function bulkEditTargets() {
        const currentAndroid = data.android.weeklyTargets[Object.keys(data.android.weeklyTargets)[0]] || CONFIG.defaultWeeklyTarget;
        const currentIOS = data.ios.weeklyTargets[Object.keys(data.ios.weeklyTargets)[0]] || CONFIG.defaultWeeklyTarget;
        
        const choice = prompt(
            `Bulk Edit Weekly Targets\n\n` +
            `Current Android target: ${currentAndroid}\n` +
            `Current iOS target: ${currentIOS}\n\n` +
            `Enter new target value for:\n` +
            `â€¢ "A:XX" for Android only (e.g., A:30)\n` +
            `â€¢ "I:XX" for iOS only (e.g., I:30)\n` +
            `â€¢ Just a number for BOTH (e.g., 30)`,
            currentAndroid
        );
        
        if (choice === null) return;
        
        const trimmed = choice.trim().toUpperCase();
        
        if (trimmed.startsWith('A:')) {
            // Android only
            const val = parseInt(trimmed.substring(2));
            if (!isNaN(val) && val > 0) {
                WEEKS.forEach(w => {
                    const key = `${w.year}-W${w.week}`;
                    data.android.weeklyTargets[key] = val;
                });
                showSaveStatus(false);
                renderTable();
                updateSummary();
                alert(`âœ… Android targets updated to ${val}/week`);
            } else {
                alert('âŒ Invalid number');
            }
        } else if (trimmed.startsWith('I:')) {
            // iOS only
            const val = parseInt(trimmed.substring(2));
            if (!isNaN(val) && val > 0) {
                WEEKS.forEach(w => {
                    const key = `${w.year}-W${w.week}`;
                    data.ios.weeklyTargets[key] = val;
                });
                showSaveStatus(false);
                renderTable();
                updateSummary();
                alert(`âœ… iOS targets updated to ${val}/week`);
            } else {
                alert('âŒ Invalid number');
            }
        } else {
            // Both platforms
            const val = parseInt(trimmed);
            if (!isNaN(val) && val > 0) {
                WEEKS.forEach(w => {
                    const key = `${w.year}-W${w.week}`;
                    data.android.weeklyTargets[key] = val;
                    data.ios.weeklyTargets[key] = val;
                });
                showSaveStatus(false);
                renderTable();
                updateSummary();
                alert(`âœ… All targets updated to ${val}/week`);
            } else {
                alert('âŒ Invalid number. Enter a positive number.');
            }
        }
    }

    // Edit total scripts
    function editTotalScripts(platform) {
        const currentTotal = platform === 'android' ? data.totalScriptsAndroid : data.totalScriptsIOS;
        const newTotal = prompt(`Enter total ${platform.toUpperCase()} scripts:`, currentTotal);
        if (newTotal !== null && !isNaN(parseInt(newTotal))) {
            if (platform === 'android') {
                data.totalScriptsAndroid = parseInt(newTotal);
            } else {
                data.totalScriptsIOS = parseInt(newTotal);
            }
            showSaveStatus(false);
            updateSummary();
        }
    }

    // Make cell editable (for targets) or open modal (for actuals)
    function makeEditable(cell, weekKey, type, platform) {
        // For actual cells, open the modal instead of inline editing
        if (type === 'actual') {
            openTestEntryModal(weekKey, platform);
            return;
        }
        
        // For target cells, use inline editing
        cell.contentEditable = true;
        cell.focus();
        
        const range = document.createRange();
        range.selectNodeContents(cell);
        const sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);

        cell.onblur = function() {
            cell.contentEditable = false;
            const value = cell.textContent.trim();
            const numValue = value === '-' || value === '' ? null : parseInt(value);
            
            const platformData = platform === 'android' ? data.android : data.ios;
            
            if (type === 'target') {
                platformData.weeklyTargets[weekKey] = numValue || CONFIG.defaultWeeklyTarget;
            }
            
            showSaveStatus(false);
            renderTable();
            updateSummary();
        };

        cell.onkeydown = function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                cell.blur();
            }
            if (e.key === 'Escape') {
                cell.contentEditable = false;
                renderTable();
            }
        };
    }

    // Calculate cumulative values for a platform
    function calculateCumulatives(platform) {
        const platformData = platform === 'android' ? data.android : data.ios;
        const totalScripts = platform === 'android' ? data.totalScriptsAndroid : data.totalScriptsIOS;
        
        let cumulativeTarget = 0;
        let cumulativeActual = 0;
        const results = [];

        WEEKS.forEach((w, idx) => {
            const key = `${w.year}-W${w.week}`;
            const target = platformData.weeklyTargets[key] || CONFIG.defaultWeeklyTarget;
            const actual = platformData.weeklyActuals[key];
            
            cumulativeTarget += target;
            if (actual !== null) {
                cumulativeActual += actual;
            }

            const variance = actual !== null ? actual - target : null;
            const cumulativeVariance = actual !== null ? cumulativeActual - cumulativeTarget : null;
            
            let status = 'future';
            if (actual !== null) {
                if (cumulativeVariance >= 0) {
                    status = 'ahead';
                } else if (cumulativeVariance >= -5) {
                    status = 'on-track';
                } else {
                    status = 'on-risk';
                }
            }

            results.push({
                ...w,
                key,
                target,
                actual,
                cumulativeTarget: Math.min(cumulativeTarget, totalScripts),
                cumulativeActual: actual !== null ? cumulativeActual : null,
                variance,
                cumulativeVariance,
                status,
                idx
            });
        });

        return results;
    }

    // Calculate projected finish week based on actual progress
    function calculateProjectedFinish(platform) {
        const platformData = platform === 'android' ? data.android : data.ios;
        const totalScripts = platform === 'android' ? data.totalScriptsAndroid : data.totalScriptsIOS;
        
        // Get all actual values
        const actuals = [];
        WEEKS.forEach((w, idx) => {
            const key = `${w.year}-W${w.week}`;
            const actual = platformData.weeklyActuals[key];
            if (actual !== null && actual > 0) {
                actuals.push({ idx, actual, week: w });
            }
        });
        
        if (actuals.length === 0) {
            return { weekIdx: null, weekLabel: '-', avgPerWeek: 0 };
        }
        
        // Calculate total completed and average per week
        const totalCompleted = actuals.reduce((sum, a) => sum + a.actual, 0);
        const avgPerWeek = totalCompleted / actuals.length;
        
        if (avgPerWeek <= 0) {
            return { weekIdx: null, weekLabel: '-', avgPerWeek: 0 };
        }
        
        // Calculate remaining scripts
        const remaining = totalScripts - totalCompleted;
        
        if (remaining <= 0) {
            // Already completed
            const lastWeek = actuals[actuals.length - 1].week;
            return { weekIdx: actuals[actuals.length - 1].idx, weekLabel: `(${lastWeek.dates}) ${lastWeek.month} ${lastWeek.year}`, avgPerWeek };
        }
        
        // Calculate weeks needed to finish
        const weeksNeeded = Math.ceil(remaining / avgPerWeek);
        const lastActualIdx = actuals[actuals.length - 1].idx;
        const projectedFinishIdx = lastActualIdx + weeksNeeded;
        
        if (projectedFinishIdx >= WEEKS.length) {
            // Projection extends beyond our defined weeks - calculate actual date
            const lastWeek = WEEKS[WEEKS.length - 1];
            const weeksAfterLast = projectedFinishIdx - (WEEKS.length - 1);
            
            // Calculate the projected date by adding weeks to the last defined week
            // Parse the last week's end date to get a starting point
            const lastWeekEndDate = parseWeekEndDate(lastWeek);
            const projectedDate = new Date(lastWeekEndDate);
            projectedDate.setDate(projectedDate.getDate() + (weeksAfterLast * 7));
            
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const projectedMonth = monthNames[projectedDate.getMonth()];
            const projectedYear = projectedDate.getFullYear();
            
            // Calculate week range for the projected date
            const dayOfWeek = projectedDate.getDay();
            const mondayOffset = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
            const monday = new Date(projectedDate);
            monday.setDate(projectedDate.getDate() + mondayOffset);
            const friday = new Date(monday);
            friday.setDate(monday.getDate() + 4);
            
            const dateRange = `${monday.getDate()}-${friday.getDate()}`;
            
            return { 
                weekIdx: projectedFinishIdx, 
                weekLabel: `(${dateRange}) ${projectedMonth} ${projectedYear}`,
                avgPerWeek,
                beyondTimeline: true
            };
        }
        
        const finishWeek = WEEKS[projectedFinishIdx];
        return { 
            weekIdx: projectedFinishIdx, 
            weekLabel: `(${finishWeek.dates}) ${finishWeek.month.split(' ')[0]} ${finishWeek.year}`,
            avgPerWeek 
        };
    }
    
    // Helper function to parse the end date of a week from WEEKS array
    function parseWeekEndDate(weekObj) {
        // weekObj.dates is like "21-25" and weekObj.month is like "Dec 2026"
        const dates = weekObj.dates.split('-');
        const endDay = parseInt(dates[1] || dates[0]);
        const monthParts = weekObj.month.split(' ');
        const monthName = monthParts[0];
        const year = weekObj.year;
        
        const monthMap = { 'Jan': 0, 'Feb': 1, 'Mar': 2, 'Apr': 3, 'May': 4, 'Jun': 5, 
                          'Jul': 6, 'Aug': 7, 'Sep': 8, 'Oct': 9, 'Nov': 10, 'Dec': 11 };
        
        return new Date(year, monthMap[monthName], endDay);
    }

    // Render the table
    function renderTable() {
        const table = document.getElementById('trackerTable');
        const androidData = calculateCumulatives('android');
        const iosData = calculateCumulatives('ios');
        const androidProjected = calculateProjectedFinish('android');
        const iosProjected = calculateProjectedFinish('ios');
        const androidTarget = calculateTargetFinish('android');
        const iosTarget = calculateTargetFinish('ios');
        
        // Group weeks by month
        const months = {};
        androidData.forEach(w => {
            if (!months[w.month]) months[w.month] = [];
            months[w.month].push(w);
        });

        let html = '';

        // Month headers (each month spans 2 columns per week)
        html += '<tr><th class="row-header" rowspan="3"></th>';
        Object.entries(months).forEach(([month, weeks]) => {
            html += `<th class="month-header" colspan="${weeks.length * 2}">${month}</th>`;
        });
        html += '</tr>';

        // Week headers
        html += '<tr>';
        androidData.forEach(w => {
            html += `<th class="week-header" colspan="2">W${w.week}<br>${w.dates}</th>`;
        });
        html += '</tr>';

        // Platform headers (Android | iOS for each week)
        html += '<tr>';
        androidData.forEach(w => {
            html += `<th class="platform-header android"><svg style="height:20px;width:auto;vertical-align:middle;" viewBox="-147 -70 294 345" fill="#073042"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg></th>`;
            html += `<th class="platform-header ios"><svg style="height:16px;width:auto;vertical-align:middle;margin-top:-4px;" viewBox="0 0 814 1000" fill="white"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg></th>`;
        });
        html += '</tr>';

        // Target row (editable) with bulk edit button
        html += '<tr><td class="row-header">Target<br>(weekly) <button onclick="bulkEditTargets()" style="font-size:9px; padding:2px 6px; border:none; background:var(--axos-orange); color:var(--axos-navy); border-radius:4px; cursor:pointer; margin-top:4px;" title="Bulk edit all targets">âœï¸ Bulk</button></td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            html += `<td class="editable" onclick="makeEditable(this, '${w.key}', 'target', 'android')">${w.target}</td>`;
            html += `<td class="editable" onclick="makeEditable(this, '${iosW.key}', 'target', 'ios')">${iosW.target}</td>`;
        });
        html += '</tr>';

        // Actual row (editable)
        html += '<tr><td class="row-header">Actual<br>(weekly)</td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            const androidDisplay = w.actual !== null ? w.actual : '-';
            const iosDisplay = iosW.actual !== null ? iosW.actual : '-';
            const androidStyle = w.actual !== null ? 
                (w.variance >= 0 ? 'background: #c8e6c9;' : 'background: #ffcdd2;') : 
                'color: #97a0af;';
            const iosStyle = iosW.actual !== null ? 
                (iosW.variance >= 0 ? 'background: #e0e0e0;' : 'background: #ffcdd2;') : 
                'color: #97a0af;';
            html += `<td class="editable" style="${androidStyle}" onclick="makeEditable(this, '${w.key}', 'actual', 'android')">${androidDisplay}</td>`;
            html += `<td class="editable" style="${iosStyle}" onclick="makeEditable(this, '${iosW.key}', 'actual', 'ios')">${iosDisplay}</td>`;
        });
        html += '</tr>';

        // Cumulative Target row (auto-calculated)
        html += '<tr class="cumulative-row"><td class="row-header">Cumulative<br>Target</td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            html += `<td class="auto-calc">${w.cumulativeTarget}</td>`;
            html += `<td class="auto-calc">${iosW.cumulativeTarget}</td>`;
        });
        html += '</tr>';

        // Cumulative Actual row (auto-calculated)
        html += '<tr><td class="row-header">Cumulative<br>Actual</td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            const androidDisplay = w.cumulativeActual !== null ? w.cumulativeActual : '-';
            const iosDisplay = iosW.cumulativeActual !== null ? iosW.cumulativeActual : '-';
            const androidStyle = w.cumulativeActual !== null ? 'background: #c8e6c9;' : 'color: #97a0af;';
            const iosStyle = iosW.cumulativeActual !== null ? 'background: #e0e0e0;' : 'color: #97a0af;';
            html += `<td class="auto-calc" style="${androidStyle}">${androidDisplay}</td>`;
            html += `<td class="auto-calc" style="${iosStyle}">${iosDisplay}</td>`;
        });
        html += '</tr>';

        // Variance row (auto-calculated)
        html += '<tr><td class="row-header">Variance<br>(+/-)</td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            
            // Android variance
            if (w.cumulativeVariance !== null) {
                const sign = w.cumulativeVariance >= 0 ? '+' : '';
                const style = w.cumulativeVariance >= 0 ? 
                    'background: #c8e6c9; color: #1b5e20;' : 
                    'background: #ffcdd2; color: #b71c1c;';
                html += `<td class="auto-calc" style="${style}; font-weight: 700;">${sign}${w.cumulativeVariance}</td>`;
            } else {
                html += `<td style="color: #97a0af;">-</td>`;
            }
            
            // iOS variance
            if (iosW.cumulativeVariance !== null) {
                const sign = iosW.cumulativeVariance >= 0 ? '+' : '';
                const style = iosW.cumulativeVariance >= 0 ? 
                    'background: #e0e0e0; color: #1b5e20;' : 
                    'background: #ffcdd2; color: #b71c1c;';
                html += `<td class="auto-calc" style="${style}; font-weight: 700;">${sign}${iosW.cumulativeVariance}</td>`;
            } else {
                html += `<td style="color: #97a0af;">-</td>`;
            }
        });
        html += '</tr>';

        // Projected Cumulative row (auto-calculated based on average)
        html += '<tr class="projected-row"><td class="row-header">ğŸ“ˆ Projected<br>Cumulative</td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            
            // Calculate projected values based on average actual
            let androidProjectedVal = '-';
            let iosProjectedVal = '-';
            
            if (androidProjected.avgPerWeek > 0) {
                androidProjectedVal = Math.round(androidProjected.avgPerWeek * (idx + 1));
                androidProjectedVal = Math.min(androidProjectedVal, data.totalScriptsAndroid);
            }
            if (iosProjected.avgPerWeek > 0) {
                iosProjectedVal = Math.round(iosProjected.avgPerWeek * (idx + 1));
                iosProjectedVal = Math.min(iosProjectedVal, data.totalScriptsIOS);
            }
            
            html += `<td style="background: #e3f2fd; color: #1565c0; font-style: italic;">${androidProjectedVal}</td>`;
            html += `<td style="background: #f5f5f5; color: #424242; font-style: italic;">${iosProjectedVal}</td>`;
        });
        html += '</tr>';

        // Status row (auto-calculated)
        html += '<tr><td class="row-header">Status</td>';
        androidData.forEach((w, idx) => {
            const iosW = iosData[idx];
            
            // Android status
            let androidStatusText = '-';
            let androidStatusClass = 'future';
            
            if (w.actual !== null) {
                if (w.status === 'ahead') {
                    androidStatusText = `âœ… +${w.cumulativeVariance}`;
                    androidStatusClass = 'ahead';
                } else if (w.status === 'on-track') {
                    androidStatusText = `âœ“ ${w.cumulativeVariance}`;
                    androidStatusClass = 'on-track';
                } else {
                    androidStatusText = `âš ï¸ ${w.cumulativeVariance}`;
                    androidStatusClass = 'on-risk';
                }
            } else {
                // Mark dynamic milestones
                // ğŸ Est. = Projected finish based on actual pace
                // ğŸ¯ Target = Week where cumulative target reaches total scripts
                if (androidProjected.weekIdx === idx) androidStatusText = 'ğŸ <svg style="width:12px;height:12px;vertical-align:middle;" viewBox="-147 -70 294 345" fill="#3ddc84"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg>';
                else if (androidTarget.weekIdx === idx) androidStatusText = 'ğŸ¯ <svg style="width:12px;height:12px;vertical-align:middle;" viewBox="-147 -70 294 345" fill="#3ddc84"><ellipse cy="41" rx="91" ry="84"/><rect rx="22" x="-91" y="20" width="182" height="182"/><rect rx="24" x="-143" y="41" width="48" height="133"/><rect rx="24" x="95" y="41" width="48" height="133"/><rect rx="6.5" x="14" y="-86" width="13" height="86" transform="rotate(29 14 0)"/><rect rx="6.5" x="-27" y="-86" width="13" height="86" transform="rotate(-29 -27 0)"/><g fill="#FFF"><circle cx="-42" cy="0" r="8"/><circle cx="42" cy="0" r="8"/></g></svg>';
            }
            
            // iOS status
            let iosStatusText = '-';
            let iosStatusClass = 'future';
            
            if (iosW.actual !== null) {
                if (iosW.status === 'ahead') {
                    iosStatusText = `âœ… +${iosW.cumulativeVariance}`;
                    iosStatusClass = 'ahead';
                } else if (iosW.status === 'on-track') {
                    iosStatusText = `âœ“ ${iosW.cumulativeVariance}`;
                    iosStatusClass = 'on-track';
                } else {
                    iosStatusText = `âš ï¸ ${iosW.cumulativeVariance}`;
                    iosStatusClass = 'on-risk';
                }
            } else {
                // Mark dynamic milestones
                if (iosProjected.weekIdx === idx) iosStatusText = 'ğŸ <svg style="width:10px;height:10px;vertical-align:middle;margin-top:-2px;" viewBox="0 0 814 1000" fill="#000"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg>';
                else if (iosTarget.weekIdx === idx) iosStatusText = 'ğŸ¯ <svg style="width:10px;height:10px;vertical-align:middle;margin-top:-2px;" viewBox="0 0 814 1000" fill="#000"><path d="M788.1 340.9c-5.8 4.5-108.2 62.2-108.2 190.5 0 148.4 130.3 200.9 134.2 202.2-.6 3.2-20.7 71.9-68.7 141.9-42.8 61.6-87.5 123.1-155.5 123.1s-85.5-39.5-164-39.5c-76.5 0-103.7 40.8-165.9 40.8s-105.6-57-155.5-127C46.7 790.7 0 663 0 541.8c0-194.4 126.4-297.5 250.8-297.5 66.1 0 121.2 43.4 162.7 43.4 39.5 0 101.1-46 176.3-46 28.5 0 130.9 2.6 198.3 99.2zm-234-181.5c31.1-36.9 53.1-88.1 53.1-139.3 0-7.1-.6-14.3-1.9-20.1-50.6 1.9-110.8 33.7-147.1 75.8-28.5 32.4-55.1 83.6-55.1 135.5 0 7.8 1.3 15.6 1.9 18.1 3.2.6 8.4 1.3 13.6 1.3 45.4 0 102.5-30.4 135.5-71.3z"/></svg>';
            }
            
            html += `<td class="status-cell ${androidStatusClass}">${androidStatusText}</td>`;
            html += `<td class="status-cell ${iosStatusClass}">${iosStatusText}</td>`;
        });
        html += '</tr>';

        table.innerHTML = html;
    }

    // Update summary stats
    // Calculate target finish date based on cumulative targets
    function calculateTargetFinish(platform) {
        const platformData = platform === 'android' ? data.android : data.ios;
        const totalScripts = platform === 'android' ? data.totalScriptsAndroid : data.totalScriptsIOS;
        
        let cumulativeTarget = 0;
        for (let i = 0; i < WEEKS.length; i++) {
            const key = `${WEEKS[i].year}-W${WEEKS[i].week}`;
            const target = platformData.weeklyTargets[key] || CONFIG.defaultWeeklyTarget;
            cumulativeTarget += target;
            
            if (cumulativeTarget >= totalScripts) {
                return {
                    weekIdx: i,
                    weekLabel: `(${WEEKS[i].dates}) ${WEEKS[i].month.split(' ')[0]} ${WEEKS[i].year}`,
                    week: WEEKS[i]
                };
            }
        }
        
        // Target extends beyond defined weeks - calculate actual date
        const lastWeek = WEEKS[WEEKS.length - 1];
        const remainingAfterLastWeek = totalScripts - cumulativeTarget;
        const avgTargetPerWeek = CONFIG.defaultWeeklyTarget || 5;
        const weeksAfterLast = Math.ceil(remainingAfterLastWeek / avgTargetPerWeek);
        
        if (weeksAfterLast > 0) {
            const lastWeekEndDate = parseWeekEndDate(lastWeek);
            const projectedDate = new Date(lastWeekEndDate);
            projectedDate.setDate(projectedDate.getDate() + (weeksAfterLast * 7));
            
            const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const projectedMonth = monthNames[projectedDate.getMonth()];
            const projectedYear = projectedDate.getFullYear();
            
            // Calculate week range for the projected date
            const dayOfWeek = projectedDate.getDay();
            const mondayOffset = dayOfWeek === 0 ? -6 : 1 - dayOfWeek;
            const monday = new Date(projectedDate);
            monday.setDate(projectedDate.getDate() + mondayOffset);
            const friday = new Date(monday);
            friday.setDate(monday.getDate() + 4);
            
            const dateRange = `${monday.getDate()}-${friday.getDate()}`;
            
            return { 
                weekIdx: WEEKS.length - 1 + weeksAfterLast, 
                weekLabel: `(${dateRange}) ${projectedMonth} ${projectedYear}`,
                week: lastWeek,
                beyondTimeline: true
            };
        }
        
        return { 
            weekIdx: WEEKS.length - 1, 
            weekLabel: `(${lastWeek.dates}) ${lastWeek.month.split(' ')[0]} ${lastWeek.year}`, 
            week: lastWeek 
        };
    }

    function updateSummary() {
        // Android
        const androidData = calculateCumulatives('android');
        const androidProjected = calculateProjectedFinish('android');
        const androidTarget = calculateTargetFinish('android');
        const lastActualAndroid = androidData.filter(w => w.actual !== null).pop();
        
        const completedAndroid = lastActualAndroid ? lastActualAndroid.cumulativeActual : 0;
        const remainingAndroid = data.totalScriptsAndroid - completedAndroid;
        const progressAndroid = Math.round((completedAndroid / data.totalScriptsAndroid) * 100);

        document.getElementById('totalScriptsAndroid').textContent = data.totalScriptsAndroid;
        document.getElementById('completedAndroid').textContent = completedAndroid;
        document.getElementById('remainingAndroid').textContent = remainingAndroid;
        document.getElementById('progressPercentAndroid').textContent = progressAndroid + '%';
        document.getElementById('avgActualAndroid').textContent = '~' + Math.round(androidProjected.avgPerWeek);
        document.getElementById('estFinishAndroid').textContent = androidProjected.weekLabel;
        document.getElementById('projectedFinishAndroid').textContent = androidProjected.weekLabel;

        const progressBarAndroid = document.getElementById('progressBarFillAndroid');
        const progressTextAndroid = document.getElementById('progressBarTextAndroid');
        progressBarAndroid.style.width = progressAndroid + '%';
        progressTextAndroid.textContent = `${progressAndroid}% Complete (${completedAndroid}/${data.totalScriptsAndroid})`;

        // iOS
        const iosData = calculateCumulatives('ios');
        const iosProjected = calculateProjectedFinish('ios');
        const iosTarget = calculateTargetFinish('ios');
        const lastActualIOS = iosData.filter(w => w.actual !== null).pop();
        
        const completedIOS = lastActualIOS ? lastActualIOS.cumulativeActual : 0;
        const remainingIOS = data.totalScriptsIOS - completedIOS;
        const progressIOS = Math.round((completedIOS / data.totalScriptsIOS) * 100);

        document.getElementById('totalScriptsIOS').textContent = data.totalScriptsIOS;
        document.getElementById('completedIOS').textContent = completedIOS;
        document.getElementById('remainingIOS').textContent = remainingIOS;
        document.getElementById('progressPercentIOS').textContent = progressIOS + '%';
        document.getElementById('avgActualIOS').textContent = '~' + Math.round(iosProjected.avgPerWeek);
        document.getElementById('estFinishIOS').textContent = iosProjected.weekLabel;
        document.getElementById('projectedFinishIOS').textContent = iosProjected.weekLabel;

        const progressBarIOS = document.getElementById('progressBarFillIOS');
        const progressTextIOS = document.getElementById('progressBarTextIOS');
        progressBarIOS.style.width = progressIOS + '%';
        progressTextIOS.textContent = `${progressIOS}% Complete (${completedIOS}/${data.totalScriptsIOS})`;

        // Update Overview sections
        updateOverview('android', androidProjected, androidTarget, completedAndroid, progressAndroid);
        updateOverview('ios', iosProjected, iosTarget, completedIOS, progressIOS);

        // Update Key Metrics
        updateKeyMetrics('android', androidProjected, completedAndroid, remainingAndroid);
        updateKeyMetrics('ios', iosProjected, completedIOS, remainingIOS);
    }
    
    function updateKeyMetrics(platform, projected, completed, remaining) {
        const suffix = platform === 'android' ? 'Android' : 'IOS';
        const totalScripts = platform === 'android' ? data.totalScriptsAndroid : data.totalScriptsIOS;
        const teamSize = 3;
        const workdaysPerWeek = 5;
        
        // Weekly Output (average per week)
        const weeklyOutput = projected.avgPerWeek || 0;
        document.getElementById(`metricWeeklyOutput${suffix}`).textContent = weeklyOutput.toFixed(2);
        
        // Team Daily Velocity (weekly output / 5 workdays)
        const dailyVelocity = weeklyOutput / workdaysPerWeek;
        document.getElementById(`metricDailyVelocity${suffix}`).textContent = dailyVelocity.toFixed(2);
        
        // Per Person Average (daily velocity / 3 people)
        const perPerson = dailyVelocity / teamSize;
        document.getElementById(`metricPerPerson${suffix}`).textContent = perPerson.toFixed(2);
        
        // Total Backlog (remaining scripts)
        document.getElementById(`metricBacklog${suffix}`).textContent = remaining;
        
        // Current Pace ETA
        if (weeklyOutput > 0) {
            const weeksToComplete = Math.ceil(remaining / weeklyOutput);
            const workdaysToComplete = Math.ceil(remaining / dailyVelocity);
            document.getElementById(`metricETA${suffix}`).textContent = `${weeksToComplete} weeks`;
            document.getElementById(`metricETADetails${suffix}`).textContent = `~${workdaysToComplete} workdays`;
        } else {
            document.getElementById(`metricETA${suffix}`).textContent = '-';
            document.getElementById(`metricETADetails${suffix}`).textContent = '~0 workdays';
        }
    }

    function updateOverview(platform, projected, target, completed, progress) {
        const statusEl = document.getElementById(`overviewStatus${platform === 'android' ? 'Android' : 'IOS'}`);
        const targetEl = document.getElementById(`overviewTarget${platform === 'android' ? 'Android' : 'IOS'}`);
        const projectedEl = document.getElementById(`overviewProjected${platform === 'android' ? 'Android' : 'IOS'}`);
        
        // Determine status
        let statusHTML = '';
        if (completed === 0) {
            statusHTML = '<span class="status-badge" style="background: #f4f5f7; color: #5e6c84;">â³ Not Started</span>';
        } else if (progress >= 100) {
            statusHTML = '<span class="status-badge" style="background: #e3fcef; color: #006644;">âœ… Completed</span>';
        } else if (projected.weekIdx === null) {
            statusHTML = '<span class="status-badge" style="background: #fffae6; color: #ff8b00;">ğŸ“Š Collecting Data</span>';
        } else if (projected.weekIdx <= target.weekIdx) {
            const weeksSaved = target.weekIdx - projected.weekIdx;
            if (weeksSaved > 0) {
                statusHTML = `<span class="status-badge ahead">ğŸš€ Ahead of Schedule</span> <span style="color: #0747a6; font-size: 12px;">â†“ ${weeksSaved} week${weeksSaved > 1 ? 's' : ''} saved</span>`;
            } else {
                statusHTML = '<span class="status-badge on-track">âœ… On Track</span>';
            }
        } else {
            const weeksBehind = projected.weekIdx - target.weekIdx;
            statusHTML = `<span class="status-badge on-risk">âš ï¸ At Risk</span> <span style="color: #bf2600; font-size: 12px;">â†‘ ${weeksBehind} week${weeksBehind > 1 ? 's' : ''} behind</span>`;
        }
        statusEl.innerHTML = statusHTML;
        
        // Update Target Finish
        targetEl.innerHTML = `<strong>${target.weekLabel}</strong> <span style="color: #5e6c84; font-size: 12px;">â€” Based on weekly targets</span>`;
        
        // Update Projected Completion
        if (projected.avgPerWeek > 0) {
            const comparison = projected.weekIdx <= target.weekIdx ? 
                `<span style="color: #006644;">âœ“ On/Ahead</span>` : 
                `<span style="color: #bf2600;">Behind target</span>`;
            projectedEl.innerHTML = `<strong>${projected.weekLabel}</strong> <span style="color: #5e6c84; font-size: 12px;">â€” Current pace (~${Math.round(projected.avgPerWeek)}/week)</span> ${comparison}`;
        } else {
            projectedEl.innerHTML = `<span style="color: #97a0af;">â€” Enter actuals to see projection</span>`;
        }
    }

    // ========================================
    // TEST ENTRY MODAL FUNCTIONS
    // ========================================
    
    function openTestEntryModal(weekKey, platform) {
        currentModalWeekKey = weekKey;
        
        // Parse week info from key
        const weekInfo = WEEKS.find(w => `${w.year}-W${w.week}` === weekKey);
        
        // Update modal title - now shows both platforms
        document.getElementById('modalTitle').innerHTML = `ğŸ“ Enter Weekly Tests`;
        document.getElementById('modalSubtitle').textContent = `Week ${weekInfo ? weekInfo.week : ''} (${weekInfo ? weekInfo.dates : ''}) - ${weekInfo ? weekInfo.month : ''}`;
        
        // Load existing entries for this week from BOTH platforms (merged)
        const androidEntries = (data.android.weeklyEntries[weekKey] || []).map(e => ({...e, platform: e.platform || 'android'}));
        const iosEntries = (data.ios.weeklyEntries[weekKey] || []).map(e => ({...e, platform: e.platform || 'ios'}));
        
        // Merge entries, avoiding duplicates by ID
        const mergedEntries = [...androidEntries];
        iosEntries.forEach(iosEntry => {
            if (!mergedEntries.find(e => e.id === iosEntry.id)) {
                mergedEntries.push(iosEntry);
            }
        });
        
        tempTestEntries = JSON.parse(JSON.stringify(mergedEntries));
        
        // Populate engineer dropdown
        populateEngineerDropdown();
        
        // Render entries list
        renderTestEntriesList();
        updateModalTotals();
        
        // Show modal
        const modal = document.getElementById('testEntryModal');
        modal.style.opacity = '1';
        modal.style.visibility = 'visible';
        modal.querySelector('.modal').style.transform = 'translateY(0)';
    }
    
    function closeTestEntryModal() {
        const modal = document.getElementById('testEntryModal');
        modal.style.opacity = '0';
        modal.style.visibility = 'hidden';
        modal.querySelector('.modal').style.transform = 'translateY(-20px)';
        
        // Clear temp data
        tempTestEntries = [];
        currentModalWeekKey = null;
        
        // Clear form fields
        document.getElementById('testName').value = '';
        document.getElementById('testAdoId').value = '';
        
        // Clear import textarea
        document.getElementById('dailyTrackerImportData').value = '';
        
        // Reset to import view (default)
        setEntryMethod('import');
    }
    
    function populateEngineerDropdown() {
        const select = document.getElementById('testEngineer');
        select.innerHTML = data.engineers.map(e => 
            `<option value="${e.id}">${e.name}</option>`
        ).join('');
    }
    
    function showAddEngineerForm() {
        document.getElementById('addEngineerBtn').style.display = 'none';
        document.getElementById('addEngineerForm').style.display = 'block';
        document.getElementById('newEngineerName').focus();
    }
    
    function hideAddEngineerForm() {
        document.getElementById('addEngineerBtn').style.display = 'inline-block';
        document.getElementById('addEngineerForm').style.display = 'none';
        document.getElementById('newEngineerName').value = '';
    }
    
    // Toggle between Import and Manual entry methods
    function setEntryMethod(method) {
        const tabImport = document.getElementById('tabImport');
        const tabManual = document.getElementById('tabManual');
        const importSection = document.getElementById('importSection');
        const manualSection = document.getElementById('manualSection');
        
        if (method === 'import') {
            tabImport.style.background = 'linear-gradient(135deg, #10b981 0%, #059669 100%)';
            tabImport.style.color = 'white';
            tabManual.style.background = '#f8fafc';
            tabManual.style.color = '#64748b';
            importSection.style.display = 'block';
            manualSection.style.display = 'none';
        } else {
            tabManual.style.background = 'var(--gradient-orange)';
            tabManual.style.color = 'var(--axos-navy)';
            tabImport.style.background = '#f8fafc';
            tabImport.style.color = '#64748b';
            importSection.style.display = 'none';
            manualSection.style.display = 'block';
        }
    }
    
    // Import tests from Daily Tracker export
    function importFromDailyTracker() {
        const importText = document.getElementById('dailyTrackerImportData').value.trim();
        
        if (!importText) {
            alert('Please paste the exported data from Daily Tracker');
            return;
        }
        
        let importData;
        try {
            importData = JSON.parse(importText);
        } catch (e) {
            alert('Invalid JSON data. Please copy the entire export from Daily Tracker.');
            return;
        }
        
        // Validate import data structure
        if (!importData.entries || !Array.isArray(importData.entries)) {
            alert('Invalid import data format. Missing "entries" array.');
            return;
        }
        
        if (importData.entries.length === 0) {
            alert('No test entries found in the import data.');
            return;
        }
        
        // Map engineer IDs from Daily Tracker to this tracker
        // First, add any new engineers from the import
        const engineerMap = {};
        if (importData.engineers && Array.isArray(importData.engineers)) {
            importData.engineers.forEach(eng => {
                const existingEngineer = data.engineers.find(e => 
                    e.name.toLowerCase() === eng.name.toLowerCase() ||
                    e.id === eng.id
                );
                
                if (existingEngineer) {
                    engineerMap[eng.id] = existingEngineer.id;
                } else {
                    // Add new engineer
                    const newId = eng.name.toLowerCase().replace(/\s+/g, '-') + '-' + Date.now();
                    data.engineers.push({ id: newId, name: eng.name });
                    engineerMap[eng.id] = newId;
                }
            });
        }
        
        // Import the tests
        let importedCount = 0;
        let skippedCount = 0;
        
        importData.entries.forEach(entry => {
            // Check for duplicates by ADO ID or test name
            const duplicateAdo = entry.adoId && tempTestEntries.find(e => e.adoId === entry.adoId);
            const duplicateName = tempTestEntries.find(e => 
                e.testName.toLowerCase() === entry.testName.toLowerCase()
            );
            
            if (duplicateAdo || duplicateName) {
                skippedCount++;
                return; // Skip duplicates
            }
            
            // Map engineer ID
            let mappedEngineerId = engineerMap[entry.engineer];
            if (!mappedEngineerId) {
                // If no mapping found, try to find engineer by name
                const existingEngineer = data.engineers.find(e => 
                    e.id === entry.engineer || 
                    e.name.toLowerCase().includes(entry.engineer.toLowerCase())
                );
                mappedEngineerId = existingEngineer ? existingEngineer.id : data.engineers[0]?.id;
            }
            
            // Create the test entry
            const newEntry = {
                id: 'entry-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9),
                engineer: mappedEngineerId,
                testName: entry.testName,
                adoId: entry.adoId || null,
                vertical: entry.vertical || 'other',
                priority: entry.priority || 'P1',
                platform: entry.platform || 'both',
                timestamp: new Date().toISOString()
            };
            
            tempTestEntries.push(newEntry);
            importedCount++;
        });
        
        // Update UI
        renderTestEntriesList();
        updateModalTotals();
        populateEngineerDropdown();
        hideImportFromDailyTracker();
        
        // AUTO-SAVE the imported entries to data store immediately
        // This prevents data loss if user closes modal without clicking Save
        const androidEntries = tempTestEntries.filter(e => e.platform === 'android' || e.platform === 'both');
        const iosEntries = tempTestEntries.filter(e => e.platform === 'ios' || e.platform === 'both');
        
        data.android.weeklyEntries[currentModalWeekKey] = tempTestEntries;
        data.ios.weeklyEntries[currentModalWeekKey] = tempTestEntries;
        
        data.android.weeklyActuals[currentModalWeekKey] = androidEntries.length > 0 ? androidEntries.length : null;
        data.ios.weeklyActuals[currentModalWeekKey] = iosEntries.length > 0 ? iosEntries.length : null;
        
        // Persist to localStorage immediately
        localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
        
        // Update the main table to show the new counts
        renderTable();
        updateSummary();
        renderWeeklyLog();
        updateBacklogBreakdown();
        
        // Mark as needing cloud sync
        showSaveStatus(false);
        
        // Show result
        let message = `âœ… Imported ${importedCount} test(s)`;
        if (skippedCount > 0) {
            message += `\nâš ï¸ Skipped ${skippedCount} duplicate(s)`;
        }
        if (importData.dateRange) {
            const rangeType = importData.dateRange.filterByCompletedDate ? 'Completed' : 'Added';
            message += `\nğŸ“… ${rangeType}: ${importData.dateRange.start || 'All time'} â†’ ${importData.dateRange.end || 'Now'}`;
        }
        message += `\n\nğŸ’¾ Data saved locally! Click "Save to Cloud" to sync.`;
        alert(message);
    }
    
    function addNewEngineer() {
        const name = document.getElementById('newEngineerName').value.trim();
        if (!name) {
            alert('Please enter an engineer name');
            return;
        }
        
        const id = name.toLowerCase().replace(/\s+/g, '-') + '-' + Date.now();
        data.engineers.push({ id, name });
        
        populateEngineerDropdown();
        document.getElementById('testEngineer').value = id;
        hideAddEngineerForm();
        showSaveStatus(false);
    }
    
    // Parse ADO ID from either a plain ID or a full URL
    function parseAdoId(input) {
        if (!input) return null;
        
        const trimmed = input.trim();
        
        // If it's just a number, return it
        if (/^\d+$/.test(trimmed)) {
            return trimmed;
        }
        
        // Try to extract ID from URL patterns like:
        // https://bofaz.visualstudio.com/Project/_workitems/edit/2194282
        // https://dev.azure.com/bofaz/Project/_workitems/edit/2194282
        const urlPattern = /_workitems\/edit\/(\d+)/;
        const match = trimmed.match(urlPattern);
        if (match) {
            return match[1];
        }
        
        // Also try pattern with just /edit/ at end
        const simplePattern = /\/(\d+)\s*$/;
        const simpleMatch = trimmed.match(simplePattern);
        if (simpleMatch) {
            return simpleMatch[1];
        }
        
        // If nothing matched but there are digits, try to extract them
        const digitsOnly = trimmed.replace(/\D/g, '');
        if (digitsOnly.length >= 5) { // ADO IDs are typically 6-7 digits
            return digitsOnly;
        }
        
        return null;
    }
    
    function addTestEntry() {
        const engineerId = document.getElementById('testEngineer').value;
        const testName = document.getElementById('testName').value.trim();
        const adoInput = document.getElementById('testAdoId').value.trim();
        const vertical = document.getElementById('testVertical').value;
        const priority = document.getElementById('testPriority').value;
        const platform = document.getElementById('testPlatform').value;
        
        if (!testName) {
            alert('Please enter a test name');
            return;
        }
        
        // Parse ADO ID from input (handles both plain ID and full URL)
        const adoId = parseAdoId(adoInput);
        
        // Check for duplicates
        const duplicateAdo = adoId && tempTestEntries.find(e => e.adoId === adoId);
        const duplicateName = tempTestEntries.find(e => e.testName.toLowerCase() === testName.toLowerCase());
        
        if (duplicateAdo) {
            if (!confirm(`âš ï¸ Warning: ADO #${adoId} already exists in this week's entries. Add anyway?`)) {
                return;
            }
        }
        
        if (duplicateName) {
            if (!confirm(`âš ï¸ Warning: A test with name "${testName}" already exists. Add anyway?`)) {
                return;
            }
        }
        
        const entry = {
            id: 'entry-' + Date.now(),
            engineer: engineerId,
            testName,
            adoId: adoId || null,
            vertical,
            priority,
            platform, // 'android', 'ios', or 'both'
            timestamp: new Date().toISOString()
        };
        
        tempTestEntries.push(entry);
        
        // Clear form
        document.getElementById('testName').value = '';
        document.getElementById('testAdoId').value = '';
        
        renderTestEntriesList();
        updateModalTotals();
    }
    
    function removeTestEntry(entryId) {
        tempTestEntries = tempTestEntries.filter(e => e.id !== entryId);
        renderTestEntriesList();
        updateModalTotals();
    }
    
    function renderTestEntriesList() {
        const container = document.getElementById('testEntriesList');
        
        if (tempTestEntries.length === 0) {
            container.innerHTML = '<p style="color: #64748b; text-align: center; padding: 24px; margin: 0;">No tests added yet. Use the form above to add tests.</p>';
            document.getElementById('entriesCount').textContent = '0 entries';
            return;
        }
        
        // Group by engineer
        const byEngineer = {};
        tempTestEntries.forEach(entry => {
            if (!byEngineer[entry.engineer]) {
                byEngineer[entry.engineer] = [];
            }
            byEngineer[entry.engineer].push(entry);
        });
        
        let html = '';
        Object.entries(byEngineer).forEach(([engineerId, entries]) => {
            const engineer = data.engineers.find(e => e.id === engineerId);
            const engineerName = engineer ? engineer.name : engineerId;
            
            html += `
                <div style="border-bottom: 1px solid #e2e8f0;">
                    <div style="background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); padding: 10px 16px; font-weight: 600; color: var(--axos-navy); display: flex; justify-content: space-between; align-items: center;">
                        <span>ğŸ‘¤ ${engineerName}</span>
                        <span style="background: var(--axos-orange); color: var(--axos-navy); padding: 2px 10px; border-radius: 12px; font-size: 12px;">${entries.length}</span>
                    </div>
                    ${entries.map(entry => `
                        <div style="padding: 10px 16px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #f1f5f9;">
                            <span style="font-size: 16px;">${getVerticalEmoji(entry.vertical)}</span>
                            <div style="flex: 1;">
                                <div style="font-weight: 500; color: var(--axos-navy); display: flex; align-items: center; gap: 8px;">
                                    ${entry.testName}
                                    ${getPlatformBadge(entry.platform)}
                                </div>
                                <div style="font-size: 11px; color: #64748b; display: flex; gap: 8px; margin-top: 2px; flex-wrap: wrap;">
                                    ${entry.adoId ? `<a href="https://bofaz.visualstudio.com/Automation%20Architecture/_workitems/edit/${entry.adoId}" target="_blank" style="color: #3b82f6; text-decoration: none;">ADO #${entry.adoId}</a>` : '<span style="color: #94a3b8;">No ADO</span>'}
                                    <span style="color: #e2e8f0;">|</span>
                                    <span>${BACKLOG_BASELINE[entry.vertical]?.name || entry.vertical}</span>
                                    <span style="color: #e2e8f0;">|</span>
                                    <span style="color: ${entry.priority === 'P0' ? '#dc2626' : entry.priority === 'P1' ? '#f59e0b' : '#3b82f6'};">${entry.priority}</span>
                                </div>
                            </div>
                            <button onclick="removeTestEntry('${entry.id}')" style="padding: 4px 8px; background: #fee2e2; border: none; border-radius: 4px; color: #dc2626; cursor: pointer; font-size: 12px;">ğŸ—‘ï¸</button>
                        </div>
                    `).join('')}
                </div>
            `;
        });
        
        container.innerHTML = html;
        document.getElementById('entriesCount').textContent = `${tempTestEntries.length} entries`;
    }
    
    function updateModalTotals() {
        const total = tempTestEntries.length;
        document.getElementById('modalTotalCount').textContent = total;
        
        // Count by platform
        const androidCount = tempTestEntries.filter(e => e.platform === 'android' || e.platform === 'both').length;
        const iosCount = tempTestEntries.filter(e => e.platform === 'ios' || e.platform === 'both').length;
        
        document.getElementById('modalAndroidCount').textContent = androidCount;
        document.getElementById('modalIOSCount').textContent = iosCount;
        
        // Count by engineer
        const byEngineer = {};
        tempTestEntries.forEach(entry => {
            const engineer = data.engineers.find(e => e.id === entry.engineer);
            const name = engineer ? engineer.name.split(' ')[0] : entry.engineer;
            byEngineer[name] = (byEngineer[name] || 0) + 1;
        });
        
        const breakdown = Object.entries(byEngineer)
            .map(([name, count]) => `${name}: ${count}`)
            .join(' | ') || '-';
        
        document.getElementById('modalEngineerBreakdown').textContent = breakdown;
    }
    
    function saveTestEntries() {
        if (!currentModalWeekKey) return;
        
        // Filter entries by platform
        const androidEntries = tempTestEntries.filter(e => e.platform === 'android' || e.platform === 'both');
        const iosEntries = tempTestEntries.filter(e => e.platform === 'ios' || e.platform === 'both');
        
        // Save all entries to a shared store (we'll use android.weeklyEntries as the main store)
        // This keeps all entries in one place, the platform field determines the count
        data.android.weeklyEntries[currentModalWeekKey] = tempTestEntries;
        data.ios.weeklyEntries[currentModalWeekKey] = tempTestEntries; // Same reference for easy sync
        
        // Update the actual counts for each platform
        data.android.weeklyActuals[currentModalWeekKey] = androidEntries.length > 0 ? androidEntries.length : null;
        data.ios.weeklyActuals[currentModalWeekKey] = iosEntries.length > 0 ? iosEntries.length : null;
        
        // Persist to localStorage immediately
        localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
        
        showSaveStatus(false);
        closeTestEntryModal();
        renderTable();
        updateSummary();
        renderWeeklyLog();
        updateBacklogBreakdown();
        
        const androidCount = androidEntries.length;
        const iosCount = iosEntries.length;
        const bothCount = tempTestEntries.filter(e => e.platform === 'both').length;
        
        let message = `âœ… Saved ${tempTestEntries.length} test entries for this week!\n\n`;
        message += `ğŸ“± Android: ${androidCount} tests\n`;
        message += `ğŸ iOS: ${iosCount} tests\n`;
        if (bothCount > 0) {
            message += `\n(${bothCount} tests marked for both platforms)`;
        }
        message += `\n\nğŸ’¾ Data saved locally! Click "Save to Cloud" to sync.`;
        
        alert(message);
    }
    
    function getVerticalEmoji(vertical) {
        const emojis = {
            'login': 'ğŸ”',
            'registration': 'ğŸ“',
            'home': 'ğŸ ',
            'bank': 'ğŸ¦',
            'borrow': 'ğŸ’³',
            'invest': 'ğŸ“ˆ',
            'plan': 'ğŸ“‹',
            'mega-menu': 'â˜°',
            'evo-chat': 'ğŸ’¬'
        };
        return emojis[vertical] || 'ğŸ“Œ';
    }
    
    function getPlatformBadge(platform) {
        if (platform === 'both') {
            return `<span style="font-size: 10px; padding: 2px 6px; border-radius: 4px; background: linear-gradient(90deg, #d1fae5 0%, #f3f4f6 100%); color: #374151; font-weight: 600;">ğŸ“± Both</span>`;
        } else if (platform === 'android') {
            return `<span style="font-size: 10px; padding: 2px 6px; border-radius: 4px; background: #d1fae5; color: #065f46; font-weight: 600;">ğŸ¤– Android</span>`;
        } else if (platform === 'ios') {
            return `<span style="font-size: 10px; padding: 2px 6px; border-radius: 4px; background: #f3f4f6; color: #374151; font-weight: 600;">ğŸ iOS</span>`;
        }
        return '';
    }
    
    // ========================================
    // WEEKLY LOG FUNCTIONS
    // ========================================
    
    function navigateWeeklyLog(direction) {
        weeklyLogWeekIdx = Math.max(0, Math.min(WEEKS.length - 1, weeklyLogWeekIdx + direction));
        renderWeeklyLog();
        updateGoToCurrentWeekButton();
    }
    
    function setLogPlatform(platform) {
        weeklyLogPlatform = platform;
        
        // Update button styles
        const androidBtn = document.getElementById('logPlatformAndroid');
        const iosBtn = document.getElementById('logPlatformIOS');
        
        if (platform === 'android') {
            androidBtn.style.background = '#d1fae5';
            androidBtn.style.borderColor = '#3ddc84';
            androidBtn.style.color = '#065f46';
            iosBtn.style.background = 'white';
            iosBtn.style.borderColor = '#e2e8f0';
            iosBtn.style.color = '#374151';
        } else {
            iosBtn.style.background = '#f3f4f6';
            iosBtn.style.borderColor = '#374151';
            iosBtn.style.color = '#111827';
            androidBtn.style.background = 'white';
            androidBtn.style.borderColor = '#e2e8f0';
            androidBtn.style.color = '#065f46';
        }
        
        renderWeeklyLog();
    }
    
    function renderWeeklyLog() {
        const container = document.getElementById('weeklyLogEntries');
        const labelEl = document.getElementById('weeklyLogLabel');
        const warningsContainer = document.getElementById('weeklyLogWarnings');
        const warningsList = document.getElementById('warningsList');
        
        const week = WEEKS[weeklyLogWeekIdx];
        const weekKey = `${week.year}-W${week.week}`;
        
        // Show current week indicator
        const isCurrentWeek = weeklyLogWeekIdx === currentWeekIdx;
        const currentBadge = isCurrentWeek ? '<span style="background: #10b981; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: 8px;">ğŸ“ Current</span>' : '';
        labelEl.innerHTML = `W${week.week} - ${week.month} (${week.dates})${currentBadge}`;
        
        // Update the "Go to Current Week" button visibility
        updateGoToCurrentWeekButton();
        
        // Get all entries for this week (stored in android.weeklyEntries as the main store)
        const allWeekEntries = data.android.weeklyEntries[weekKey] || [];
        
        // Filter by selected platform
        const entries = allWeekEntries.filter(entry => {
            if (weeklyLogPlatform === 'android') {
                return entry.platform === 'android' || entry.platform === 'both';
            } else {
                return entry.platform === 'ios' || entry.platform === 'both';
            }
        });
        
        // Check for warnings (duplicates across all weeks)
        const allEntries = getAllEntries(weeklyLogPlatform);
        const duplicateGroups = findDuplicateGroups(allEntries);
        
        // Store for modal use
        window.currentDuplicateGroups = duplicateGroups;
        
        if (duplicateGroups.length > 0) {
            warningsContainer.style.display = 'block';
            warningsList.innerHTML = `<p style="margin: 0;">Found <strong>${duplicateGroups.length}</strong> duplicate group(s). Click "View Details & Remove" to see where each duplicate appears and remove them.</p>`;
        } else {
            warningsContainer.style.display = 'none';
        }
        
        if (entries.length === 0) {
            container.innerHTML = '<p style="color: #64748b; text-align: center; padding: 40px;">No entries for this week. Click on an "Actual" cell to add test entries.</p>';
            return;
        }
        
        // Group by engineer
        const byEngineer = {};
        entries.forEach(entry => {
            if (!byEngineer[entry.engineer]) {
                byEngineer[entry.engineer] = [];
            }
            byEngineer[entry.engineer].push(entry);
        });
        
        let html = '';
        Object.entries(byEngineer).forEach(([engineerId, engineerEntries]) => {
            const engineer = data.engineers.find(e => e.id === engineerId);
            const engineerName = engineer ? engineer.name : engineerId;
            
            html += `
                <div style="border-bottom: 2px solid #e2e8f0;">
                    <div style="background: linear-gradient(135deg, var(--axos-navy) 0%, var(--axos-navy-light) 100%); color: white; padding: 12px 16px; font-weight: 600; display: flex; justify-content: space-between; align-items: center;">
                        <span>ğŸ‘¤ ${engineerName}</span>
                        <span style="background: var(--axos-orange); color: var(--axos-navy); padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 700;">${engineerEntries.length} tests</span>
                    </div>
                    <div style="padding: 0;">
                        ${engineerEntries.map(entry => `
                            <div style="padding: 12px 16px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #f1f5f9; background: white;">
                                <span style="font-size: 20px;">${getVerticalEmoji(entry.vertical)}</span>
                                <div style="flex: 1;">
                                    <div style="font-weight: 600; color: var(--axos-navy); display: flex; align-items: center; gap: 8px; flex-wrap: wrap;">
                                        ${entry.testName}
                                        ${getPlatformBadge(entry.platform)}
                                    </div>
                                    <div style="font-size: 12px; color: #64748b; display: flex; gap: 12px; margin-top: 4px; flex-wrap: wrap;">
                                        ${entry.adoId ? `<a href="https://bofaz.visualstudio.com/Automation%20Architecture/_workitems/edit/${entry.adoId}" target="_blank" style="color: #3b82f6; text-decoration: none; font-weight: 500;">ğŸ”— ADO #${entry.adoId}</a>` : '<span style="color: #94a3b8;">No ADO link</span>'}
                                        <span>${BACKLOG_BASELINE[entry.vertical]?.name || entry.vertical}</span>
                                        <span style="padding: 1px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; background: ${entry.priority === 'P0' ? '#fee2e2' : entry.priority === 'P1' ? '#fef3c7' : '#dbeafe'}; color: ${entry.priority === 'P0' ? '#dc2626' : entry.priority === 'P1' ? '#92400e' : '#1d4ed8'};">${entry.priority}</span>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        });
        
        container.innerHTML = html;
    }
    
    function getAllEntries(platform) {
        // All entries are now stored in android.weeklyEntries as the main store
        const allEntries = [];
        
        Object.values(data.android.weeklyEntries || {}).forEach(entries => {
            entries.forEach(entry => {
                // Filter by platform
                if (platform === 'android' && (entry.platform === 'android' || entry.platform === 'both')) {
                    allEntries.push(entry);
                } else if (platform === 'ios' && (entry.platform === 'ios' || entry.platform === 'both')) {
                    allEntries.push(entry);
                }
            });
        });
        
        return allEntries;
    }
    
    // Get all entries with their week information
    function getAllEntriesWithWeek() {
        const entries = [];
        
        Object.entries(data.android.weeklyEntries || {}).forEach(([weekKey, weekEntries]) => {
            weekEntries.forEach(entry => {
                entries.push({
                    ...entry,
                    weekKey,
                    weekInfo: getWeekInfoFromKey(weekKey)
                });
            });
        });
        
        return entries;
    }
    
    // Get week info from week key (e.g., "2026-W1" -> {week: 1, month: "Jan 2026", dates: "29-2"})
    function getWeekInfoFromKey(weekKey) {
        const week = WEEKS.find(w => `${w.year}-W${w.week}` === weekKey);
        if (week) {
            return { week: week.week, month: week.month, dates: week.dates, year: week.year };
        }
        // Fallback parsing
        const match = weekKey.match(/(\d{4})-W(\d+)/);
        if (match) {
            return { week: parseInt(match[2]), year: parseInt(match[1]), month: 'Unknown', dates: '' };
        }
        return { week: 0, month: 'Unknown', dates: '', year: 0 };
    }
    
    // Find duplicate groups across all weeks
    function findDuplicateGroups(allEntries) {
        const duplicateGroups = [];
        const processedAdoIds = new Set();
        const processedTestNames = new Set();
        
        // Get all entries with week information
        const entriesWithWeek = getAllEntriesWithWeek();
        
        // Group by ADO ID
        entriesWithWeek.forEach(entry => {
            if (entry.adoId && !processedAdoIds.has(entry.adoId)) {
                const matches = entriesWithWeek.filter(e => e.adoId === entry.adoId);
                if (matches.length > 1) {
                    // Sort by week to determine original
                    matches.sort((a, b) => {
                        const aKey = `${a.weekInfo.year}-${String(a.weekInfo.week).padStart(2, '0')}`;
                        const bKey = `${b.weekInfo.year}-${String(b.weekInfo.week).padStart(2, '0')}`;
                        return aKey.localeCompare(bKey);
                    });
                    
                    duplicateGroups.push({
                        type: 'ado',
                        identifier: `ADO #${entry.adoId}`,
                        testName: matches[0].testName,
                        entries: matches
                    });
                    processedAdoIds.add(entry.adoId);
                }
            }
        });
        
        // Group by test name (only if no ADO ID match already found)
        entriesWithWeek.forEach(entry => {
            const lowerName = entry.testName.toLowerCase();
            if (!processedTestNames.has(lowerName)) {
                const matches = entriesWithWeek.filter(e => 
                    e.testName.toLowerCase() === lowerName
                );
                
                // Only add if not already covered by ADO group and has duplicates
                if (matches.length > 1) {
                    const alreadyInAdoGroup = duplicateGroups.some(g => 
                        g.type === 'ado' && g.entries.some(e => e.testName.toLowerCase() === lowerName)
                    );
                    
                    if (!alreadyInAdoGroup) {
                        matches.sort((a, b) => {
                            const aKey = `${a.weekInfo.year}-${String(a.weekInfo.week).padStart(2, '0')}`;
                            const bKey = `${b.weekInfo.year}-${String(b.weekInfo.week).padStart(2, '0')}`;
                            return aKey.localeCompare(bKey);
                        });
                        
                        duplicateGroups.push({
                            type: 'name',
                            identifier: `"${entry.testName}"`,
                            testName: entry.testName,
                            entries: matches
                        });
                    }
                    processedTestNames.add(lowerName);
                }
            }
        });
        
        return duplicateGroups;
    }
    
    // Show duplicate details modal
    function showDuplicateDetailsModal() {
        const groups = window.currentDuplicateGroups || [];
        
        if (groups.length === 0) {
            alert('No duplicates found.');
            return;
        }
        
        let html = `
            <div id="duplicateDetailsModal" class="modal-overlay show" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;" onclick="if(event.target === this) closeDuplicateDetailsModal()">
                <div class="modal" style="background: white; border-radius: 16px; padding: 0; width: 900px; max-width: 95%; max-height: 90vh; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.3);" onclick="event.stopPropagation()">
                    <div style="background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%); color: white; padding: 20px 24px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <h3 style="margin: 0; font-size: 1.25rem;">âš ï¸ Duplicate Entries Details</h3>
                            <p style="margin: 4px 0 0 0; font-size: 12px; opacity: 0.8;">Found ${groups.length} duplicate group(s)</p>
                        </div>
                        <button onclick="closeDuplicateDetailsModal()" style="background: rgba(255,255,255,0.1); border: none; color: white; width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 18px;">âœ•</button>
                    </div>
                    
                    <div style="padding: 24px; max-height: calc(90vh - 200px); overflow-y: auto;">
        `;
        
        groups.forEach((group, groupIdx) => {
            html += `
                <div style="margin-bottom: 20px; border: 2px solid #fecaca; border-radius: 12px; overflow: hidden;">
                    <div style="background: #fef2f2; padding: 12px 16px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong style="color: #dc2626;">${group.identifier}</strong>
                            <span style="font-size: 12px; color: #92400e; margin-left: 8px;">(${group.entries.length} occurrences)</span>
                        </div>
                        <button type="button" onclick="event.stopPropagation(); removeDuplicatesInGroup(${groupIdx})" style="padding: 6px 14px; background: #dc2626; border: none; border-radius: 6px; color: white; font-weight: 600; font-size: 11px; cursor: pointer;">
                            ğŸ—‘ï¸ Keep Original Only
                        </button>
                    </div>
                    <div style="padding: 12px 16px;">
            `;
            
            group.entries.forEach((entry, idx) => {
                const isOriginal = idx === 0;
                const engineer = data.engineers.find(e => e.id === entry.engineer);
                const engineerName = engineer ? engineer.name : entry.engineer;
                
                html += `
                    <div style="padding: 10px 12px; margin-bottom: 8px; border-radius: 8px; background: ${isOriginal ? '#d1fae5' : '#fef3c7'}; border-left: 4px solid ${isOriginal ? '#10b981' : '#f59e0b'};">
                        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px;">
                            <div>
                                <span style="font-weight: 600; color: ${isOriginal ? '#065f46' : '#92400e'};">
                                    ${isOriginal ? 'âœ… ORIGINAL' : 'âš ï¸ DUPLICATE'}
                                </span>
                                <span style="margin-left: 12px; font-size: 13px; color: #374151;">
                                    ğŸ“… <strong>${entry.weekInfo.month}</strong>, W${entry.weekInfo.week} (${entry.weekInfo.dates})
                                </span>
                            </div>
                            <div style="font-size: 12px; color: #64748b;">
                                ğŸ‘¤ ${engineerName}
                            </div>
                        </div>
                        <div style="font-size: 12px; color: #64748b; margin-top: 6px;">
                            ${entry.testName}
                            ${entry.adoId ? `<span style="margin-left: 8px;">â€¢ ADO #${entry.adoId}</span>` : ''}
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
        });
        
        html += `
                    </div>
                    
                    <div style="padding: 16px 24px; background: #f8fafc; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
                        <span style="font-size: 13px; color: #64748b;">âš¡ Removing duplicates will keep only the original (earliest) entry</span>
                        <div style="display: flex; gap: 12px;">
                            <button type="button" onclick="event.stopPropagation(); removeAllDuplicates()" style="padding: 10px 20px; background: #dc2626; border: none; border-radius: 8px; color: white; font-weight: 600; cursor: pointer;">
                                ğŸ—‘ï¸ Remove All Duplicates
                            </button>
                            <button onclick="closeDuplicateDetailsModal()" style="padding: 10px 20px; background: #e2e8f0; border: none; border-radius: 8px; color: #374151; font-weight: 600; cursor: pointer;">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        document.body.insertAdjacentHTML('beforeend', html);
    }
    
    // Close duplicate details modal
    function closeDuplicateDetailsModal() {
        const modal = document.getElementById('duplicateDetailsModal');
        if (modal) modal.remove();
    }
    
    // Remove duplicates in a specific group (keep only original)
    function removeDuplicatesInGroup(groupIdx) {
        try {
            const groups = window.currentDuplicateGroups || [];
            const group = groups[groupIdx];
            
            if (!group) {
                alert('Error: Group not found. Please close and reopen the duplicate details.');
                return;
            }
            
            if (!group.entries || group.entries.length < 2) {
                alert('Error: Not enough entries in group.');
                return;
            }
            
            // Get entries to remove (all except the first one which is the original)
            const entriesToRemove = group.entries.slice(1);
            const originalEntry = group.entries[0];
            
            const confirmMsg = `Remove ${entriesToRemove.length} duplicate(s) for ${group.identifier}?\n\nThis will keep only the original entry from ${originalEntry.weekInfo?.month || 'Unknown'}, W${originalEntry.weekInfo?.week || '?'}.`;
            
            if (!confirm(confirmMsg)) {
                return;
            }
            
            let removedCount = 0;
            
            // Remove from data
            entriesToRemove.forEach(entry => {
                if (!entry.weekKey) {
                    console.warn('Entry missing weekKey:', entry);
                    return;
                }
                const weekEntries = data.android.weeklyEntries[entry.weekKey];
                if (weekEntries) {
                    const idx = weekEntries.findIndex(e => e.id === entry.id);
                    if (idx !== -1) {
                        weekEntries.splice(idx, 1);
                        removedCount++;
                    }
                }
            });
            
            // Recalculate actuals for affected weeks
            recalculateWeekActuals();
            
            // Persist to localStorage immediately
            localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
            
            // Refresh the UI
            showSaveStatus(false);
            renderTable();
            updateSummary();
            renderWeeklyLog();
            updateBacklogBreakdown();
            
            // Check if there are remaining duplicates
            const remainingDuplicates = collectDuplicateGroups();
            
            if (remainingDuplicates.length === 0) {
                // No more duplicates - close modal and notify
                closeDuplicateDetailsModal();
                alert(`âœ… Removed ${removedCount} duplicate(s). No more duplicates found!\n\nğŸ’¾ Data saved locally! Click "Save to Cloud" to sync.`);
            } else {
                // Still have duplicates - refresh the modal instead of closing
                closeDuplicateDetailsModal();
                showDuplicateDetailsModal(remainingDuplicates);
                
                // Show a brief notification (non-blocking)
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
                    background: #10b981; color: white; padding: 12px 24px; border-radius: 8px;
                    font-weight: 600; z-index: 10001; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                `;
                notification.textContent = `âœ… Removed ${removedCount} duplicate(s). ${remainingDuplicates.length} group(s) remaining.`;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);
            }
        } catch (err) {
            console.error('Error removing duplicates:', err);
            alert('Error removing duplicates: ' + err.message);
        }
    }
    
    // Collect duplicate groups from current data (used to refresh modal)
    function collectDuplicateGroups() {
        const adoIdCount = {};
        const testNameCount = {};
        
        // Scan all weekly entries for duplicates
        Object.keys(data.android.weeklyEntries || {}).forEach(weekKey => {
            const entries = data.android.weeklyEntries[weekKey] || [];
            const weekInfo = WEEKS.find(w => `${w.year}-W${w.week}` === weekKey);
            
            entries.forEach(entry => {
                const entryWithMeta = {
                    ...entry,
                    weekKey,
                    weekInfo: weekInfo || { week: '?', dates: '?', month: '?' }
                };
                
                // Track by ADO ID
                if (entry.adoId) {
                    if (!adoIdCount[entry.adoId]) {
                        adoIdCount[entry.adoId] = [];
                    }
                    adoIdCount[entry.adoId].push(entryWithMeta);
                }
                
                // Track by test name
                const normalizedName = entry.testName.toLowerCase().trim();
                if (!testNameCount[normalizedName]) {
                    testNameCount[normalizedName] = [];
                }
                testNameCount[normalizedName].push(entryWithMeta);
            });
        });
        
        // Build duplicate groups
        const duplicateGroups = [];
        const processedIds = new Set();
        
        // Check ADO ID duplicates
        Object.entries(adoIdCount).forEach(([adoId, entries]) => {
            if (entries.length > 1) {
                // Sort by week to show oldest first (original)
                entries.sort((a, b) => {
                    const aWeekNum = a.weekInfo.week || 0;
                    const bWeekNum = b.weekInfo.week || 0;
                    return aWeekNum - bWeekNum;
                });
                
                duplicateGroups.push({
                    type: 'ado',
                    identifier: `ADO #${adoId}`,
                    entries: entries
                });
                
                entries.forEach(e => processedIds.add(e.id));
            }
        });
        
        // Check test name duplicates (only for entries not already flagged by ADO)
        Object.entries(testNameCount).forEach(([name, entries]) => {
            const unprocessedEntries = entries.filter(e => !processedIds.has(e.id));
            if (unprocessedEntries.length > 1) {
                // Sort by week to show oldest first
                unprocessedEntries.sort((a, b) => {
                    const aWeekNum = a.weekInfo.week || 0;
                    const bWeekNum = b.weekInfo.week || 0;
                    return aWeekNum - bWeekNum;
                });
                
                duplicateGroups.push({
                    type: 'name',
                    identifier: `"${unprocessedEntries[0].testName}"`,
                    entries: unprocessedEntries
                });
            }
        });
        
        return duplicateGroups;
    }
    
    // Recalculate week actuals after removing entries
    function recalculateWeekActuals() {
        // Go through all weeks and recalculate actuals based on entries
        Object.keys(data.android.weeklyEntries || {}).forEach(weekKey => {
            const entries = data.android.weeklyEntries[weekKey] || [];
            const androidEntries = entries.filter(e => e.platform === 'android' || e.platform === 'both');
            const iosEntries = entries.filter(e => e.platform === 'ios' || e.platform === 'both');
            
            data.android.weeklyActuals[weekKey] = androidEntries.length > 0 ? androidEntries.length : null;
            data.ios.weeklyActuals[weekKey] = iosEntries.length > 0 ? iosEntries.length : null;
        });
    }
    
    // Remove all duplicates across all groups
    function removeAllDuplicates() {
        try {
            const groups = window.currentDuplicateGroups || [];
            
            if (groups.length === 0) {
                alert('No duplicates to remove.');
                return;
            }
            
            let totalDuplicates = 0;
            groups.forEach(g => totalDuplicates += (g.entries?.length || 1) - 1);
            
            if (totalDuplicates === 0) {
                alert('No duplicates to remove.');
                return;
            }
            
            if (!confirm(`Remove ALL ${totalDuplicates} duplicate entries across ${groups.length} groups?\n\nThis will keep only the original (earliest) entry for each test.`)) {
                return;
            }
            
            let removedCount = 0;
            
            // Remove all duplicates
            groups.forEach(group => {
                if (!group.entries || group.entries.length < 2) return;
                
                const entriesToRemove = group.entries.slice(1);
                entriesToRemove.forEach(entry => {
                    if (!entry.weekKey) {
                        console.warn('Entry missing weekKey:', entry);
                        return;
                    }
                    const weekEntries = data.android.weeklyEntries[entry.weekKey];
                    if (weekEntries) {
                        const idx = weekEntries.findIndex(e => e.id === entry.id);
                        if (idx !== -1) {
                            weekEntries.splice(idx, 1);
                            removedCount++;
                        }
                    }
                });
            });
            
            // Recalculate actuals for affected weeks
            recalculateWeekActuals();
            
            // Persist to localStorage immediately
            localStorage.setItem('mobileAutomationTrackerDual', JSON.stringify(data));
            
            // Close modal and refresh
            closeDuplicateDetailsModal();
            showSaveStatus(false);
            renderTable();
            updateSummary();
            renderWeeklyLog();
            updateBacklogBreakdown();
            
            alert(`âœ… Removed ${removedCount} duplicate(s).\n\nğŸ’¾ Data saved locally! Click "Save to Cloud" to sync.`);
        } catch (err) {
            console.error('Error removing all duplicates:', err);
            alert('Error removing duplicates: ' + err.message);
        }
    }
    
    // ========================================
    // BACKLOG BREAKDOWN FUNCTIONS
    // ========================================
    
    function calculateCompletedByVertical() {
        // For backlog breakdown, we count UNIQUE tests (not platform instances)
        // A test marked "Both" counts as 1 test, not 2
        // Tests added separately for Android and iOS with same ADO ID or test name are also counted once
        const completed = {};
        
        // Initialize
        Object.keys(BACKLOG_BASELINE).forEach(vertical => {
            completed[vertical] = { P0: 0, P1: 0, P2: 0, total: 0 };
        });
        
        // Track unique tests to prevent double counting
        // Tests may appear in both android and ios stores, or be marked for "both" platforms
        // We want to count each unique TEST CASE only once, not platform implementations
        const countedTests = new Set();
        
        // Process entries from both stores to ensure we don't miss any
        const allWeeklyEntries = [
            ...Object.values(data.android.weeklyEntries || {}),
            ...Object.values(data.ios.weeklyEntries || {})
        ];
        
        allWeeklyEntries.forEach(entries => {
            if (!Array.isArray(entries)) return;
            
            entries.forEach(entry => {
                const vertical = entry.vertical;
                const priority = entry.priority;
                
                if (!completed[vertical]) return;
                
                // Create a unique key - prefer ADO ID, fall back to test name + vertical
                // This ensures each test case is counted only once regardless of platform
                const uniqueKey = entry.adoId 
                    ? `ado-${entry.adoId}` 
                    : `name-${(entry.testName || '').toLowerCase().trim()}-${vertical}`;
                
                // Skip if we've already counted this test
                if (countedTests.has(uniqueKey)) return;
                countedTests.add(uniqueKey);
                
                completed[vertical][priority]++;
                completed[vertical].total++;
            });
        });
        
        return completed;
    }
    
    function updateBacklogBreakdown() {
        const completed = calculateCompletedByVertical();
        
        // Update the table cells
        const rows = document.querySelectorAll('#backlogTable tbody tr');
        rows.forEach(row => {
            const verticalKey = row.dataset.vertical;
            if (!verticalKey || !BACKLOG_BASELINE[verticalKey]) return;
            
            const baseline = BACKLOG_BASELINE[verticalKey];
            const verticalCompleted = completed[verticalKey] || { P0: 0, P1: 0, P2: 0, total: 0 };
            
            // Update P0, P1, P2, Total cells with completion info
            const p0Cell = row.querySelector('.p0-cell');
            const p1Cell = row.querySelector('.p1-cell');
            const p2Cell = row.querySelector('.p2-cell');
            const totalCell = row.querySelector('.total-cell');
            
            if (p0Cell) {
                p0Cell.innerHTML = verticalCompleted.P0 > 0 
                    ? `${baseline.P0} <span style="color: #10b981; font-size: 11px;">(${verticalCompleted.P0} âœ“)</span>`
                    : baseline.P0;
            }
            
            if (p1Cell) {
                p1Cell.innerHTML = verticalCompleted.P1 > 0 
                    ? `${baseline.P1} <span style="color: #10b981; font-size: 11px;">(${verticalCompleted.P1} âœ“)</span>`
                    : baseline.P1;
            }
            
            if (p2Cell) {
                p2Cell.innerHTML = verticalCompleted.P2 > 0 
                    ? `${baseline.P2} <span style="color: #10b981; font-size: 11px;">(${verticalCompleted.P2} âœ“)</span>`
                    : baseline.P2;
            }
            
            if (totalCell) {
                totalCell.innerHTML = verticalCompleted.total > 0 
                    ? `${baseline.total} <span style="color: #10b981; font-size: 11px;">(${verticalCompleted.total} âœ“)</span>`
                    : baseline.total;
            }
        });
        
        // Update totals row
        const totalsRow = document.querySelector('#backlogTable tfoot tr');
        if (totalsRow) {
            let totalP0 = 0, totalP1 = 0, totalP2 = 0, grandTotal = 0;
            let completedP0 = 0, completedP1 = 0, completedP2 = 0, completedTotal = 0;
            
            Object.keys(BACKLOG_BASELINE).forEach(key => {
                const baseline = BACKLOG_BASELINE[key];
                totalP0 += baseline.P0;
                totalP1 += baseline.P1;
                totalP2 += baseline.P2;
                grandTotal += baseline.total;
                
                completedP0 += completed[key]?.P0 || 0;
                completedP1 += completed[key]?.P1 || 0;
                completedP2 += completed[key]?.P2 || 0;
                completedTotal += completed[key]?.total || 0;
            });
            
            const p0Total = totalsRow.querySelector('.p0-total');
            const p1Total = totalsRow.querySelector('.p1-total');
            const p2Total = totalsRow.querySelector('.p2-total');
            const grandTotalCell = totalsRow.querySelector('.grand-total');
            
            if (p0Total) p0Total.innerHTML = completedP0 > 0 ? `${totalP0} <span style="color: #FAA74A;">(${completedP0} âœ“)</span>` : totalP0;
            if (p1Total) p1Total.innerHTML = completedP1 > 0 ? `${totalP1} <span style="color: #FAA74A;">(${completedP1} âœ“)</span>` : totalP1;
            if (p2Total) p2Total.innerHTML = completedP2 > 0 ? `${totalP2} <span style="color: #FAA74A;">(${completedP2} âœ“)</span>` : totalP2;
            if (grandTotalCell) grandTotalCell.innerHTML = completedTotal > 0 ? `${grandTotal} <span style="color: #FAA74A;">(${completedTotal} âœ“)</span>` : grandTotal;
        }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', async function() {
        await loadData();
        
        // Set the weekly log to the current week
        currentWeekIdx = findCurrentWeekIndex();
        weeklyLogWeekIdx = currentWeekIdx;
        
        renderTable();
        updateSummary();
        renderWeeklyLog();
        updateBacklogBreakdown();
        updateGoToCurrentWeekButton();
    });
</script>

</body>
</html>
